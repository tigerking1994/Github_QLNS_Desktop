<Window x:Class="VTS.QLNS.CTC.App.View.Budget.Settlement.Army.ArmyDetail"
        x:Name="ArmyDetailWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:wpf="clr-namespace:MaterialDesignThemes.Wpf;assembly=MaterialDesignThemes.Wpf"
        xmlns:localEnum="clr-namespace:VTS.QLNS.CTC.Utility.Enum;assembly=VTS.QLNS.CTC.Utility"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        xmlns:component="clr-namespace:VTS.QLNS.CTC.App.Component"
        xmlns:ext="clr-namespace:VTS.QLNS.CTC.App.Extensions" xmlns:army="clr-namespace:VTS.QLNS.CTC.App.ViewModel.Budget.Army" d:DataContext="{d:DesignInstance Type=army:ArmyDetailViewModel}"
        mc:Ignorable="d"
        Style="{StaticResource MaterialDesignWindow}" 
        Title="Quân số - Chứng từ chi tiết" 
        Height="800"
        Width="1600"
        WindowStartupLocation="CenterScreen"
        WindowState="Maximized"
        Icon="/favicon.ico">
    <Window.InputBindings>
        <KeyBinding Key="F4" Command="{Binding DeleteCommand}" CommandParameter="{Binding ElementName=DgArmyDetailUpdate, Path=.}"/>
        <KeyBinding Key="F10" Command="{Binding SaveDataCommand}" />
        <KeyBinding Key="F5" Command="{Binding RefreshCommand}" />
    </Window.InputBindings>
    <materialDesign:DialogHost
        Identifier="ArmyDetailDialog"
        DialogTheme="Inherit">
        <Grid Margin="16">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*" />
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            <StackPanel 
                Grid.Row="0"
                Orientation="Vertical">
                <DockPanel>
                    <materialDesign:PackIcon Kind="Dollar" Style="{StaticResource DialogScreenIconStyle}"/>
                    <StackPanel Orientation="Vertical" VerticalAlignment="Center">
                        <TextBlock Text="CHỨNG TỪ CHI TIẾT" FontWeight="Bold"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Orientation="Horizontal" Grid.Column="0">
                                <TextBlock>
                                    <TextBlock.Text>
                                        <MultiBinding StringFormat="Năm làm việc: {0} | Số: {1} - QĐ: {2} - Ngày: {3} | Tháng: {4}">
                                            <Binding Path="NamLamViec" />
                                            <Binding Path="ArmyVoucher.SSoChungTu" />
                                            <Binding Path="ArmyVoucher.SSoQuyetDinh" />
                                            <Binding Path="ArmyVoucher.DNgayQuyetDinh" Converter="{StaticResource DateTimeToStringConverter}" />
                                            <Binding Path="ArmyVoucher.IThangQuy" />
                                        </MultiBinding>
                                    </TextBlock.Text>
                                </TextBlock>
                            </StackPanel>
                        </Grid>
                    </StackPanel>
                </DockPanel>
                <Separator Background="{DynamicResource MaterialDesignDivider}"/>
            </StackPanel>
            <StackPanel
                Grid.Row="1"
                Orientation="Horizontal">
                <ComboBox
                    materialDesign:HintAssist.Hint="-- Tháng --"
                    materialDesign:TextFieldAssist.HasClearButton="False"
                    DisplayMemberPath="DisplayItem"
                    SelectedValuePath="ValueItem"
                    SelectedItem="{Binding SelectedMonth}"
                    ItemsSource="{Binding Months}"
                    Padding="0 7 0 7">
                </ComboBox>
                <Separator Style="{StaticResource SearchBarHorizontalDividerStyle}" />
                <ComboBox
                    Margin="10 0 5 0"
                    materialDesign:HintAssist.Hint="-- Đon vị --"
                    materialDesign:TextFieldAssist.HasClearButton="False"
                    DisplayMemberPath="DisplayItem"
                    SelectedValuePath="ValueItem"
                    SelectedItem="{Binding SelectedAgency}"
                    ItemsSource="{Binding Agencies}"
                    Padding="0 7 0 7">
                </ComboBox>
                <Separator Style="{StaticResource SearchBarHorizontalDividerStyle}" />
                <StackPanel Orientation="Horizontal" Visibility="{Binding IsEdit, Converter={StaticResource BooleanToVisibilityConverter}}">
                    <TextBlock x:Name="TblIsEdit" Text="{Binding IsEdit}" Visibility="Collapsed"/>
                    <Button 
                        Style="{StaticResource SearchBarBtnStyle}" 
                        ToolTip="Xóa dữ liệu"
                        Command="{Binding DeleteCommand}" CommandParameter="{Binding ElementName=DgArmyDetailUpdate, Path=.}">
                        <StackPanel Orientation="Horizontal">
                            <materialDesign:PackIcon Kind="Delete" />
                            <TextBlock Style="{StaticResource SearchBarBtnTextStyle}" Text="Xóa (F4)"/>
                        </StackPanel>
                    </Button>
                    <Separator Style="{StaticResource SearchBarHorizontalDividerStyle}" />
                    <Button 
                        ext:Permission.Identifier="BUDGET_SETTLEMENT_ARMY_DETAIL_BTN_DELETE_ALL"
                        Style="{StaticResource SearchBarBtnStyle}" 
                        IsEnabled="{Binding IsDeleteAll}"
                        Command="{Binding DeleteAllCommand}">
                        <StackPanel Orientation="Horizontal">
                            <materialDesign:PackIcon Kind="DeleteForever" />
                            <TextBlock Style="{StaticResource SearchBarBtnTextStyle}" Text="Xóa tất cả"/>
                        </StackPanel>
                    </Button>
                    <Separator Style="{StaticResource SearchBarHorizontalDividerStyle}"/>
                    <Button 
                        Style="{StaticResource SearchBarBtnStyle}" 
                        IsEnabled="{Binding IsSaveData}"
                        Command="{Binding SaveDataCommand}">
                        <StackPanel Orientation="Horizontal">
                            <materialDesign:PackIcon Kind="ContentSave" />
                            <TextBlock Style="{StaticResource SearchBarBtnTextStyle}" Text="Lưu dữ liệu (F10)"/>
                        </StackPanel>
                    </Button>
                    <Separator Style="{StaticResource SearchBarHorizontalDividerStyle}" />
                </StackPanel>
                <Button 
                    ext:Permission.Identifier="BUDGET_SETTLEMENT_ARMY_DETAIL_BTN_LOCK"
                    Style="{StaticResource SearchBarBtnStyle}"
                    Command="{Binding LockCommand}">
                    <StackPanel Orientation="Horizontal">
                        <materialDesign:PackIcon Kind="{Binding IsLock, Converter={StaticResource InvertBooleanToLockIconConverter}}" />
                        <TextBlock
                            Style="{StaticResource SearchBarBtnTextStyle}" 
                            x:Name="TblLock"
                            Text="{Binding IsLock, Converter={StaticResource InvertBooleanToLockStatusConverter}}"/>
                    </StackPanel>
                </Button>
                <Separator Style="{StaticResource SearchBarHorizontalDividerStyle}" />
                <Button 
                    Style="{StaticResource SearchBarBtnStyle}"
                    ToolTip="Refresh"
                    Command="{Binding RefreshCommand}">
                    <StackPanel Orientation="Horizontal">
                        <materialDesign:PackIcon Kind="Refresh" />
                        <TextBlock Style="{StaticResource SearchBarBtnTextStyle}" Text="(F5)"/>
                    </StackPanel>
                </Button>
                <Separator Style="{StaticResource SearchBarHorizontalDividerStyle}" />
                <Button
                    ext:Permission.Identifier="BUDGET_SETTLEMENT_ARMY_DETAIL_BTN_EXPORT"
                    x:Name="btnExcelSummary" 
                    Style="{StaticResource SearchBarBtnStyle}" 
                    Command="{Binding ExportCommand}" >
                    <StackPanel Orientation="Horizontal">
                        <materialDesign:PackIcon Kind="FileExcel" />
                        <TextBlock Style="{StaticResource SearchBarBtnTextStyle}" Text="Xuất dữ liệu"/>
                        <materialDesign:PopupBox
                            Margin="-10 0 0 0"
                            Grid.Column="1" 
                            HorizontalAlignment="Right"
                            IsPopupOpen="{Binding IsOpenExportPopup, Mode=TwoWay}">
                            <materialDesign:PopupBox.ToggleContent>
                                <materialDesign:PackIcon Kind="MenuDown" />
                            </materialDesign:PopupBox.ToggleContent>
                            <StackPanel>
                                <Button
                                        Command="{Binding ExportAggregateDataCommand}"
                                        CommandParameter="{x:Static localEnum:ArmyExportCheckType.EXPORT_AGGREGATE_TYPE}"
                                        Content="Xuất dữ liệu tổng hợp" />
                                <Button
                                        Command="{Binding ExportAggregateDataCommand}"
                                        CommandParameter="{x:Static localEnum:ArmyExportCheckType.EXPORT_UNIT_TYPE}"
                                        Content="Xuất dữ liệu theo đơn vị đã chọn" />
                                <Button
                                        Command="{Binding ExportAggregateDataCommand}"
                                        CommandParameter="{x:Static localEnum:ArmyExportCheckType.EXPORT_UNITS_TYPE}"
                                        Content="Xuất dữ liệu tất cả các đơn vị quản lý có số liệu quyết toán" />
                            </StackPanel>
                        </materialDesign:PopupBox>
                    </StackPanel>
                </Button>
                <Separator Style="{StaticResource SearchBarHorizontalDividerStyle}" />
                <Button 
                    ext:Permission.Identifier="BUDGET_SETTLEMENT_ARMY_DETAIL_BTN_PRINT_REPORT"
                    Style="{StaticResource SearchBarBtnStyle}" 
                    Command="{Binding PrintCommand}">
                    <StackPanel Orientation="Horizontal">
                        <materialDesign:PackIcon Kind="Printer" />
                        <TextBlock Style="{StaticResource SearchBarBtnTextStyle}" Text="In báo cáo"/>
                        <materialDesign:PopupBox
                            Margin="-10 0 0 0"
                            Grid.Column="1" 
                            HorizontalAlignment="Right"
                            IsPopupOpen="{Binding IsOpenPrintPopup, Mode=TwoWay}">
                            <materialDesign:PopupBox.ToggleContent>
                                <materialDesign:PackIcon Kind="MenuDown" />
                            </materialDesign:PopupBox.ToggleContent>
                            <StackPanel>
                                <Button Command="{Binding PrintActionCommand}" CommandParameter="{x:Static localEnum:ArmyPrintType.PRINT_ARMY}" Content="1. Báo cáo quân số" />
                            </StackPanel>
                        </materialDesign:PopupBox>
                    </StackPanel>
                </Button>
                <Separator Style="{StaticResource SearchBarHorizontalDividerStyle}" />
                <Button 
                    Style="{StaticResource SearchBarBtnStyle}" 
                    IsEnabled="{Binding IsGetDataLuong}"
                    Command="{Binding GetDataCommand}">
                    <StackPanel Orientation="Horizontal">
                        <materialDesign:PackIcon Kind="Transfer"/>
                        <TextBlock Style="{StaticResource SearchBarBtnTextStyle}" Text="Lấy số liệu quyết toán quân số lương"/>
                    </StackPanel>
                </Button>
                <Separator Style="{StaticResource SearchBarHorizontalDividerStyle}" />
                <Button x:Name="btnShowColSelfPay" Style="{StaticResource SearchBarBtnStyle}">
                    <StackPanel Orientation="Horizontal">
                        <materialDesign:PackIcon Kind="PlusMinusVariant" />
                        <TextBlock Style="{StaticResource SearchBarBtnTextStyle}" Text="Ẩn/hiện cột" />
                        <materialDesign:PopupBox
                            Name="pbDynamicColumn"
                            Margin="-10 0 0 0"
                            HorizontalAlignment="Right"
                            StaysOpen="True">
                            <materialDesign:PopupBox.Resources>
                                <Style TargetType="ScrollViewer">
                                    <Setter Property="Height" Value="400" />
                                </Style>
                            </materialDesign:PopupBox.Resources>
                            <materialDesign:PopupBox.ToggleContent>
                                <materialDesign:PackIcon Kind="MenuDown"/>
                            </materialDesign:PopupBox.ToggleContent>
                            <ScrollViewer></ScrollViewer>
                        </materialDesign:PopupBox>
                    </StackPanel>
                </Button>
                <Separator Style="{StaticResource SearchBarHorizontalDividerStyle}" />
                <ComboBox
                    Name="cbFrozenColumn"
                    materialDesign:HintAssist.Hint="Cố định cột"
                    DisplayMemberPath="DisplayItem"
                    SelectedValuePath="ValueItem"/>
                <Separator Style="{StaticResource SearchBarHorizontalDividerStyle}" />
                <Button 
                    Style="{StaticResource SearchBarBtnStyle}" 
                    Command="{Binding CloseCommand}"
                    CommandParameter="{Binding ElementName=ArmyDetailWindow}">
                    <StackPanel Orientation="Horizontal">
                        <materialDesign:PackIcon Kind="CloseOutline" />
                        <TextBlock Style="{StaticResource SearchBarBtnTextStyle}" Text="Đóng"/>
                    </StackPanel>
                </Button>
            </StackPanel>
            <component:ExpandedDataGrid
                x:Name="DgArmyDetailChange"
                Grid.Row="3"
                Margin="0 5 0 0"
                VerticalAlignment="Top"
                BorderThickness="1"
                AutoGenerateColumns="False"
                CanUserResizeColumns="True"
                CanUserReorderColumns="False"
                HorizontalScrollBarVisibility="Auto"
                FrozenColumnCount="2"
                MinColumnWidth="60"
                CanUserAddRows="False"
                CanUserSortColumns="False"
                GridLinesVisibility="All"
                ColumnInfo="{Binding Columns}"
                ElementFrozenColumn="{Binding ElementName=cbFrozenColumn, Path=., Mode=TwoWay}"
                ElementDynamicColumn="{Binding ElementName=pbDynamicColumn, Path=., Mode=TwoWay}"
                Style="{StaticResource MaterialDesignDataGrid}"
                RowStyle="{StaticResource DataGridRowDetail}"
                CellStyle="{StaticResource DataGridCellDetail}"
                ItemsSource="{Binding ArmyVoucherDetails}"
                SelectedItem="{Binding SelectedArmyVoucherDetail}"
                wpf:DataGridAssist.CornerRadius="0 0 4 4">
                <DataGrid.Columns>
                    <component:DataGridTextColumn 
                        x:Name="XauNoiMa"
                        Binding="{Binding SKyHieu}" 
                        Header="#" 
                        IsReadOnly="True"
                        ElementStyle="{StaticResource DataGridTextColumnDetailStyle}"
                        HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}">
                        <DataGridColumn.HeaderTemplate>
                            <DataTemplate>
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition />
                                        <RowDefinition />
                                    </Grid.RowDefinitions>
                                    <Border
                                        Padding="{Binding RelativeSource={RelativeSource Self}, Path=(wpf:DataGridAssist.ColumnHeaderPadding), Converter={StaticResource HeaderPaddingConverter}}">
                                        <Canvas Height="{Binding ElementName=HeaderGroup, Path=ActualHeight}">
                                            <Grid>
                                                <Grid.Style>
                                                    <Style TargetType="Grid">
                                                        <Setter Property="Width">
                                                            <Setter.Value>
                                                                <MultiBinding Converter="{StaticResource MultipleWidthConverter}">
                                                                    <Binding ElementName="XauNoiMa" Path="ActualWidth"/>
                                                                    <Binding ElementName="MoTa" Path="ActualWidth"/>
                                                                </MultiBinding>
                                                            </Setter.Value>
                                                        </Setter>
                                                    </Style>
                                                </Grid.Style>
                                                <TextBlock HorizontalAlignment="Center" Text="Mục lục ngân sách"/>
                                            </Grid>
                                        </Canvas>
                                    </Border>
                                    <Border
                                        Grid.Row="1"
                                        Padding="{Binding RelativeSource={RelativeSource Self}, Path=(wpf:DataGridAssist.ColumnHeaderPadding)}"
                                        BorderThickness="0 1 1 0"
                                        BorderBrush="{Binding HorizontalGridLinesBrush, RelativeSource={RelativeSource AncestorType=DataGrid}}">
                                        <TextBlock Name="HeaderGroup" Text="{Binding}"/>
                                    </Border>
                                </Grid>
                            </DataTemplate>
                        </DataGridColumn.HeaderTemplate>
                    </component:DataGridTextColumn>
                    <component:DataGridTextColumn 
                        x:Name="MoTa"
                        Binding="{Binding SMoTa}" 
                        Header="Mô tả"
                        IsReadOnly="True"
                        ElementStyle="{StaticResource DataGridTextColumnDetailStyle}"
                        HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                        HeaderTemplate="{StaticResource RightHeader}"/>

                    <component:DataGridTextColumn 
                        x:Name="Tong"
                        Header="Tổng cộng"
                        Binding="{Binding Tong, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        IsReadOnly="True"
                        FontWeight="Bold">
                    </component:DataGridTextColumn>

                    <component:DataGridTextColumn 
                        x:Name="TongSiQuan"
                        Header="(+)"
                        Width="70"
                        IsReadOnly="True"
                        FontWeight="Bold"
                        Binding="{Binding TongSiQuan, UpdateSourceTrigger=LostFocus, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        EditingElementStyle="{StaticResource DataGridTextColumnEditingRightCell}"
                        HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}">
                        <DataGridColumn.HeaderTemplate>
                            <DataTemplate>
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition />
                                        <RowDefinition />
                                    </Grid.RowDefinitions>
                                    <Border
                                        Padding="{Binding RelativeSource={RelativeSource Self}, Path=(wpf:DataGridAssist.ColumnHeaderPadding), Converter={StaticResource HeaderPaddingConverter}}">
                                        <Canvas Height="{Binding ElementName=HeaderGroup, Path=ActualHeight}">
                                            <Grid>
                                                <Grid.Style>
                                                    <Style TargetType="Grid">
                                                        <Setter Property="Width">
                                                            <Setter.Value>
                                                                <MultiBinding Converter="{StaticResource MultipleWidthConverter}">
                                                                    <Binding ElementName="TongSiQuan" Path="ActualWidth"/>
                                                                    <Binding ElementName="RTuong" Path="ActualWidth"/>
                                                                    <Binding ElementName="RDaiTa" Path="ActualWidth"/>
                                                                    <Binding ElementName="RThuongTa" Path="ActualWidth"/>
                                                                    <Binding ElementName="RTrungTa" Path="ActualWidth"/>
                                                                    <Binding ElementName="RThieuTa" Path="ActualWidth"/>
                                                                    <Binding ElementName="RDaiUy" Path="ActualWidth"/>
                                                                    <Binding ElementName="RThuongUy" Path="ActualWidth"/>
                                                                    <Binding ElementName="RTrungUy" Path="ActualWidth"/>
                                                                    <Binding ElementName="RThieuUy" Path="ActualWidth"/>
                                                                </MultiBinding>
                                                            </Setter.Value>
                                                        </Setter>
                                                    </Style>
                                                </Grid.Style>
                                                <TextBlock HorizontalAlignment="Center" Text="Sĩ quan"/>
                                            </Grid>
                                        </Canvas>
                                    </Border>
                                    <Border
                                        Grid.Row="1"
                                        Padding="{Binding RelativeSource={RelativeSource Self}, Path=(wpf:DataGridAssist.ColumnHeaderPadding)}"
                                        BorderThickness="0 1 1 0"
                                        BorderBrush="{Binding HorizontalGridLinesBrush, RelativeSource={RelativeSource AncestorType=DataGrid}}">
                                        <TextBlock Name="HeaderGroup" Text="{Binding}"/>
                                    </Border>
                                </Grid>
                            </DataTemplate>
                        </DataGridColumn.HeaderTemplate>
                    </component:DataGridTextColumn>

                    <component:DataGridTextColumn 
                        x:Name="RTuong"
                        Header="TG"
                        Width="70"
                        StringFormat="{}{0:N0}"
                        Binding="{Binding FSoTuong, UpdateSourceTrigger=LostFocus, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        EditingElementStyle="{StaticResource DataGridTextColumnEditingRightCell}"
                        HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                        HeaderTemplate="{StaticResource CenterHeader}"/>
                    <component:DataGridTextColumn 
                        x:Name="RDaiTa"
                        Header="24"
                        Width="70"
                        StringFormat="{}{0:N0}"
                        Binding="{Binding FSoDaiTa, UpdateSourceTrigger=LostFocus, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        EditingElementStyle="{StaticResource DataGridTextColumnEditingRightCell}"
                        HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                        HeaderTemplate="{StaticResource CenterHeader}"/>
                    <component:DataGridTextColumn 
                        x:Name="RThuongTa"
                        Header="23"
                        Width="70"
                        StringFormat="{}{0:N0}"
                        Binding="{Binding FSoThuongTa, UpdateSourceTrigger=LostFocus, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        EditingElementStyle="{StaticResource DataGridTextColumnEditingRightCell}"
                        HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                        HeaderTemplate="{StaticResource CenterHeader}"/>
                    <component:DataGridTextColumn
                        Header="22"
                        Width="70"
                        x:Name="RTrungTa"
                        StringFormat="{}{0:N0}"
                        Binding="{Binding FSoTrungTa, UpdateSourceTrigger=LostFocus, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        EditingElementStyle="{StaticResource DataGridTextColumnEditingRightCell}"
                        HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                        HeaderTemplate="{StaticResource CenterHeader}"/>
                    <component:DataGridTextColumn 
                         x:Name="RThieuTa"
                         Header="21"
                         Width="70"
                         StringFormat="{}{0:N0}"
                         Binding="{Binding FSoThieuTa, UpdateSourceTrigger=LostFocus, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}}" 
                         ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                         EditingElementStyle="{StaticResource DataGridTextColumnEditingRightCell}"
                         HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                         HeaderTemplate="{StaticResource CenterHeader}"/>

                    <component:DataGridTextColumn 
                        x:Name="RDaiUy"
                        Header="14"
                        Width="70"
                        StringFormat="{}{0:N0}"
                        Binding="{Binding FSoDaiUy, UpdateSourceTrigger=LostFocus, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        EditingElementStyle="{StaticResource DataGridTextColumnEditingRightCell}"
                        HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                        HeaderTemplate="{StaticResource CenterHeader}"/>
                    
                    <component:DataGridTextColumn 
                        x:Name="RThuongUy"
                        Header="13"
                        Width="70"
                        StringFormat="{}{0:N0}"
                        Binding="{Binding FSoThuongUy, UpdateSourceTrigger=LostFocus, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        EditingElementStyle="{StaticResource DataGridTextColumnEditingRightCell}"
                        HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                        HeaderTemplate="{StaticResource CenterHeader}"/>

                    <component:DataGridTextColumn 
                        x:Name="RTrungUy"
                        Header="12"
                        Width="70"
                        StringFormat="{}{0:N0}"
                        Binding="{Binding FSoTrungUy, UpdateSourceTrigger=LostFocus, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        EditingElementStyle="{StaticResource DataGridTextColumnEditingRightCell}"
                        HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                        HeaderTemplate="{StaticResource CenterHeader}"/>

                    <component:DataGridTextColumn 
                        x:Name="RThieuUy"
                        Header="11"
                        Width="70"
                        StringFormat="{}{0:N0}"
                        Binding="{Binding FSoThieuUy, UpdateSourceTrigger=LostFocus, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        EditingElementStyle="{StaticResource DataGridTextColumnEditingRightCell}"
                        HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                        HeaderTemplate="{StaticResource RightHeader}"/>



                    <component:DataGridTextColumn 
                        x:Name="TongQNCN"
                        Header="(+)"
                        IsReadOnly="True"
                        Width="70"
                        FontWeight="Bold"
                        StringFormat="{}{0:N0}"
                        Binding="{Binding TongQNCN, UpdateSourceTrigger=LostFocus, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        EditingElementStyle="{StaticResource DataGridTextColumnEditingRightCell}"
                        HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}">
                        <DataGridColumn.HeaderTemplate>
                            <DataTemplate>
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition />
                                        <RowDefinition />
                                    </Grid.RowDefinitions>
                                    <Border
                                        Padding="{Binding RelativeSource={RelativeSource Self}, Path=(wpf:DataGridAssist.ColumnHeaderPadding), Converter={StaticResource HeaderPaddingConverter}}">
                                        <Canvas Height="{Binding ElementName=HeaderGroup, Path=ActualHeight}">
                                            <Grid>
                                                <Grid.Style>
                                                    <Style TargetType="Grid">
                                                        <Setter Property="Width">
                                                            <Setter.Value>
                                                                <MultiBinding Converter="{StaticResource MultipleWidthConverter}">
                                                                    <Binding ElementName="TongQNCN" Path="ActualWidth"/>
                                                                    <Binding ElementName="SoThuongTaQNCN" Path="ActualWidth"/>
                                                                    <Binding ElementName="SoTrungTaQNCN" Path="ActualWidth"/>
                                                                    <Binding ElementName="SoThieuTaQNCN" Path="ActualWidth"/>
                                                                    <Binding ElementName="SoDaiUyQNCN" Path="ActualWidth"/>
                                                                    <Binding ElementName="SoThuongUyQNCN" Path="ActualWidth"/>
                                                                    <Binding ElementName="SoTrungUyQNCN" Path="ActualWidth"/>
                                                                    <Binding ElementName="SoThieuUyQNCN" Path="ActualWidth"/>
                                                                </MultiBinding>
                                                            </Setter.Value>
                                                        </Setter>
                                                    </Style>
                                                </Grid.Style>
                                                <TextBlock HorizontalAlignment="Center" Text="Quân nhân chuyên nghiệp"/>
                                            </Grid>
                                        </Canvas>
                                    </Border>
                                    <Border
                                        Grid.Row="1"
                                        Padding="{Binding RelativeSource={RelativeSource Self}, Path=(wpf:DataGridAssist.ColumnHeaderPadding)}"
                                        BorderThickness="0 1 1 0"
                                        BorderBrush="{Binding HorizontalGridLinesBrush, RelativeSource={RelativeSource AncestorType=DataGrid}}">
                                        <TextBlock Name="HeaderGroup" Text="{Binding}"/>
                                    </Border>
                                </Grid>
                            </DataTemplate>
                        </DataGridColumn.HeaderTemplate>
                    </component:DataGridTextColumn>

                    <component:DataGridTextColumn 
                        x:Name="SoThuongTaQNCN"
                        Header="23"
                        Width="70"
                        StringFormat="{}{0:N0}"
                        Binding="{Binding FSoThuongTaQNCN, UpdateSourceTrigger=LostFocus, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        EditingElementStyle="{StaticResource DataGridTextColumnEditingRightCell}"
                        HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                        HeaderTemplate="{StaticResource CenterHeader}"/>

                    <component:DataGridTextColumn 
                        x:Name="SoTrungTaQNCN"
                        Header="22"
                        Width="70"
                        StringFormat="{}{0:N0}"
                        Binding="{Binding FSoTrungTaQNCN, UpdateSourceTrigger=LostFocus, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        EditingElementStyle="{StaticResource DataGridTextColumnEditingRightCell}"
                        HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                        HeaderTemplate="{StaticResource CenterHeader}"/>

                    <component:DataGridTextColumn 
                        x:Name="SoThieuTaQNCN"
                        Header="21"
                        Width="70"
                        StringFormat="{}{0:N0}"
                        Binding="{Binding FSoThieuTaQNCN, UpdateSourceTrigger=LostFocus, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        EditingElementStyle="{StaticResource DataGridTextColumnEditingRightCell}"
                        HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                        HeaderTemplate="{StaticResource CenterHeader}"/>

                    <component:DataGridTextColumn 
                        x:Name="SoDaiUyQNCN"
                        Header="14"
                        Width="70"
                        StringFormat="{}{0:N0}"
                        Binding="{Binding FSoDaiUyQNCN, UpdateSourceTrigger=LostFocus, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        EditingElementStyle="{StaticResource DataGridTextColumnEditingRightCell}"
                        HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                        HeaderTemplate="{StaticResource CenterHeader}"/>

                    <component:DataGridTextColumn 
                        x:Name="SoThuongUyQNCN"
                        Header="13"
                        Width="70"
                        StringFormat="{}{0:N0}"
                        Binding="{Binding FSoThuongUyQNCN, UpdateSourceTrigger=LostFocus, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        EditingElementStyle="{StaticResource DataGridTextColumnEditingRightCell}"
                        HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                        HeaderTemplate="{StaticResource CenterHeader}"/>

                    <component:DataGridTextColumn 
                        x:Name="SoTrungUyQNCN"
                        Header="12"
                        Width="70"
                        StringFormat="{}{0:N0}"
                        Binding="{Binding FSoTrungUyQNCN, UpdateSourceTrigger=LostFocus, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        EditingElementStyle="{StaticResource DataGridTextColumnEditingRightCell}"
                        HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                        HeaderTemplate="{StaticResource CenterHeader}"/>

                    <component:DataGridTextColumn 
                        x:Name="SoThieuUyQNCN"
                        Header="11"
                        Width="70"
                        StringFormat="{}{0:N0}"
                        Binding="{Binding FSoThieuUyQNCN, UpdateSourceTrigger=LostFocus, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        EditingElementStyle="{StaticResource DataGridTextColumnEditingRightCell}"
                        HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                        HeaderTemplate="{StaticResource RightHeader}"/>

                    <component:DataGridTextColumn 
                        x:Name="TongHaSiQuan"
                        Header="(+)"
                        Width="70"
                        FontWeight="Bold"
                        IsReadOnly="True"
                        StringFormat="{}{0:N0}"
                        Binding="{Binding TongHaSiQuan, UpdateSourceTrigger=LostFocus, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        EditingElementStyle="{StaticResource DataGridTextColumnEditingRightCell}"
                        HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}">
                        <DataGridColumn.HeaderTemplate>
                            <DataTemplate>
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition />
                                        <RowDefinition />
                                    </Grid.RowDefinitions>
                                    <Border
                                        Padding="{Binding RelativeSource={RelativeSource Self}, Path=(wpf:DataGridAssist.ColumnHeaderPadding), Converter={StaticResource HeaderPaddingConverter}}">
                                        <Canvas Height="{Binding ElementName=HeaderGroup, Path=ActualHeight}">
                                            <Grid>
                                                <Grid.Style>
                                                    <Style TargetType="Grid">
                                                        <Setter Property="Width">
                                                            <Setter.Value>
                                                                <MultiBinding Converter="{StaticResource MultipleWidthConverter}">
                                                                    <Binding ElementName="TongHaSiQuan" Path="ActualWidth"/>
                                                                    <Binding ElementName="RThuongSi" Path="ActualWidth" />
                                                                    <Binding ElementName="RTrungSi" Path="ActualWidth"/>
                                                                    <Binding ElementName="RHaSi" Path="ActualWidth"/>
                                                                    <Binding ElementName="RBinhNhat" Path="ActualWidth"/>
                                                                    <Binding ElementName="RBinhNhi" Path="ActualWidth"/>
                                                                </MultiBinding>
                                                            </Setter.Value>
                                                        </Setter>
                                                    </Style>
                                                </Grid.Style>
                                                <TextBlock HorizontalAlignment="Center" Text="Hạ sĩ quan, binh sĩ"/>
                                            </Grid>
                                        </Canvas>
                                    </Border>
                                    <Border
                                        Grid.Row="1"
                                        Padding="{Binding RelativeSource={RelativeSource Self}, Path=(wpf:DataGridAssist.ColumnHeaderPadding)}"
                                        BorderThickness="0 1 1 0"
                                        BorderBrush="{Binding HorizontalGridLinesBrush, RelativeSource={RelativeSource AncestorType=DataGrid}}">
                                        <TextBlock Name="HeaderGroup" Text="{Binding}"/>
                                    </Border>
                                </Grid>
                            </DataTemplate>
                        </DataGridColumn.HeaderTemplate>
                    </component:DataGridTextColumn>
                    <component:DataGridTextColumn 
                        x:Name="RThuongSi"
                        Header="H3"
                        Width="70"
                        StringFormat="{}{0:N0}"
                        Binding="{Binding FSoThuongSi, UpdateSourceTrigger=LostFocus, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        EditingElementStyle="{StaticResource DataGridTextColumnEditingRightCell}"
                        HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                        HeaderTemplate="{StaticResource CenterHeader}"/>
                    <component:DataGridTextColumn 
                        x:Name="RTrungSi"
                        Header="H2"
                        Width="70"
                        StringFormat="{}{0:N0}"
                        Binding="{Binding FSoTrungSi, UpdateSourceTrigger=LostFocus, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        EditingElementStyle="{StaticResource DataGridTextColumnEditingRightCell}"
                        HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                        HeaderTemplate="{StaticResource CenterHeader}"/>
                    <component:DataGridTextColumn 
                        x:Name="RHaSi"
                        Header="H1"
                        Width="70"
                        StringFormat="{}{0:N0}"
                        Binding="{Binding FSoHaSi, UpdateSourceTrigger=LostFocus, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        EditingElementStyle="{StaticResource DataGridTextColumnEditingRightCell}"
                        HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                        HeaderTemplate="{StaticResource CenterHeader}"/>
                    <component:DataGridTextColumn 
                        x:Name="RBinhNhat"
                        Header="B1"
                        Width="70"
                        StringFormat="{}{0:N0}"
                        Binding="{Binding FSoBinhNhat, UpdateSourceTrigger=LostFocus, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        EditingElementStyle="{StaticResource DataGridTextColumnEditingRightCell}"
                        HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                        HeaderTemplate="{StaticResource CenterHeader}"/>
                    <DataGridTextColumn 
                        x:Name="RBinhNhi"
                        Header="B2"
                        Width="70"
                        Binding="{Binding FSoBinhNhi, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        EditingElementStyle="{StaticResource DataGridTextColumnEditingRightCell}"
                        HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                        HeaderTemplate="{StaticResource RightHeader}"/>

                    <component:DataGridTextColumn 
                        x:Name="RCcqp"
                        Header="CCQP"
                        Width="70"
                        StringFormat="{}{0:N0}"
                        Binding="{Binding FSoCcqp, UpdateSourceTrigger=LostFocus, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        EditingElementStyle="{StaticResource DataGridTextColumnEditingRightCell}"/>
                    
                    <component:DataGridTextColumn 
                        x:Name="RCnvqp"
                        Header="CNVQP"
                        Width="70"
                        StringFormat="{}{0:N0}"
                        Binding="{Binding FSoCnvqp, UpdateSourceTrigger=LostFocus, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        EditingElementStyle="{StaticResource DataGridTextColumnEditingRightCell}"/> 

                    <component:DataGridTextColumn 
                        x:Name="RVcqp"
                        Header="VCQP"
                        Width="70"
                        StringFormat="{}{0:N0}"
                        Binding="{Binding FSoVcqp, UpdateSourceTrigger=LostFocus, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        EditingElementStyle="{StaticResource DataGridTextColumnEditingRightCell}"/>

                    <component:DataGridTextColumn 
                        x:Name="RLdhd"
                        Header="Khác"
                        Width="70"
                        StringFormat="{}{0:N0}"
                        Binding="{Binding FSoLdhd, UpdateSourceTrigger=LostFocus, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        EditingElementStyle="{StaticResource DataGridTextColumnEditingRightCell}"/>
                    <DataGridTextColumn 
                        x:Name="GhiChu"
                        Header="Ghi chú"
                        Binding="{Binding SGhiChu, UpdateSourceTrigger=LostFocus}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailStyle}"
                        EditingElementStyle="{StaticResource DataGridTextColumnEditingStyle}"/>

                </DataGrid.Columns>
            </component:ExpandedDataGrid>
        </Grid>
    </materialDesign:DialogHost>    
</Window>
