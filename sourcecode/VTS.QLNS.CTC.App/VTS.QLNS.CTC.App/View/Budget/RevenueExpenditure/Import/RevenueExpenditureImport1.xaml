<Window x:Class="VTS.QLNS.CTC.App.View.Budget.RevenueExpenditure.Import.RevenueExpenditureImport1"
        x:Name="RevenueExpenditureImportWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
        xmlns:local="clr-namespace:VTS.QLNS.CTC.App.View.Budget.RevenueExpenditure.Import"
        xmlns:system="clr-namespace:System;assembly=mscorlib"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        xmlns:wpf="clr-namespace:MaterialDesignThemes.Wpf;assembly=MaterialDesignThemes.Wpf"
        xmlns:localEnum="clr-namespace:VTS.QLNS.CTC.Utility;assembly=VTS.QLNS.CTC.Utility"
                xmlns:component="clr-namespace:VTS.QLNS.CTC.App.Component"
        mc:Ignorable="d" 
        WindowState="Maximized"
        d:DesignHeight="450" d:DesignWidth="800">
    <Grid Margin="16">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            <DockPanel Grid.Row="0">
                <materialDesign:PackIcon Kind="MicrosoftExcel" Style="{StaticResource DialogScreenIconStyle}"/>
                <StackPanel Orientation="Vertical" VerticalAlignment="Center" Margin="10 0">
                    <TextBlock Text="IMPORT DỮ LIỆU THU NỘP NGÂN SÁCH" FontWeight="Bold"/>
                    <TextBlock Text="Chọn file Excel"/>
                </StackPanel>
            </DockPanel>
            <Separator Grid.Row="1" Background="{DynamicResource MaterialDesignDivider}"/>
            <Grid Grid.Row="2">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                <Border BorderThickness="1" BorderBrush="{DynamicResource MaterialDesignDivider}" Margin="0 10 0 0" Padding="5 0">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBox
                            Grid.Column="0"
                            IsEnabled="False"
                            materialDesign:HintAssist.Hint="Lựa chọn file Excel"
                            materialDesign:TextFieldAssist.DecorationVisibility="Hidden"
                            BorderThickness="0"
                            VerticalAlignment="Center" 
                            Text="{Binding FileName}"/>
                        <Button
                            Style="{DynamicResource MaterialDesignToolButton}"
                            Grid.Column="1"
                            Command="{Binding UploadFileCommand}">
                            <materialDesign:PackIcon
                                Kind="FileUpload"
                                Margin="8 0 0 0" />
                        </Button>
                    </Grid>
                </Border>

                <Grid
                    Grid.Row="1"
                    Margin="0 10 0 0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <TextBox Margin="10 0 0 0"
                             Visibility="{Binding VisibilitySoChungTu}"
                             Text="{Binding SSoChungTu}"
                             Width="150"
                             IsReadOnly="True"
                             IsEnabled="False"
                             materialDesign:HintAssist.Hint="Số"
                             Style="{StaticResource MaterialDesignFloatingHintTextBox}" />
                    <DatePicker Grid.Column="1"
                                Visibility="{Binding VisibilityDNgayChungTu}"
                                Language="vi-VN"
                                Margin="10 0 0 0"
                                Width="150"
                                SelectedDate="{Binding DNgayChungTu}"
                                materialDesign:HintAssist.Hint="Ngày"
                                Style="{StaticResource MaterialDesignFloatingHintDatePicker}" />
                    <ComboBox 
                        Margin="10 0 10 0"
                        Visibility="{Binding VisibilityMonth}"
                        Grid.Column="2"
                        materialDesign:HintAssist.Hint="Chọn theo quý/tháng"
                        materialDesign:TextFieldAssist.HasClearButton="True"
                        Style="{StaticResource MaterialDesignFloatingHintComboBox}"
                        DisplayMemberPath="DisplayItem"
                        SelectedValuePath="ValueItem"  
                        SelectedItem="{Binding QuarterMonthSelected}"
                        ItemsSource="{Binding QuarterMonths}"/>
                    <ComboBox 
                        Visibility="{Binding VisibilityMonth}"
                        Grid.Column="3"
                        materialDesign:HintAssist.Hint="Chọn tháng"
                        materialDesign:TextFieldAssist.HasClearButton="True"
                        Style="{StaticResource MaterialDesignFloatingHintComboBox}"
                        DisplayMemberPath="DisplayItem"
                        SelectedValuePath="ValueItem"  
                        SelectedItem="{Binding TimeOptionSelected}"
                        ItemsSource="{Binding TimeOptions}"/>

                    <ComboBox 
                        Visibility="{Binding VisibilityUnit}"
                        Grid.Column="5"
                        Margin="10 0 0 0"
                        materialDesign:HintAssist.Hint="Chọn đơn vị"
                        materialDesign:TextFieldAssist.HasClearButton="True"
                        Style="{StaticResource MaterialDesignFloatingHintComboBox}"
                        DisplayMemberPath="DisplayItem"
                        SelectedValuePath="ValueItem"  
                        SelectedItem="{Binding AgencySelected}"
                        ItemsSource="{Binding Agencies}"/>
                    <StackPanel Grid.Column="6" Orientation="Horizontal">
                        <Button 
                            Margin="10 0 0 0"
                            Width="120"
                            Style="{StaticResource MaterialDesignRaisedButton}"
                            Command="{Binding ProcessFileCommand}">
                            <StackPanel Orientation="Horizontal">
                                <materialDesign:PackIcon Kind="FileCheck" />
                                <TextBlock Style="{StaticResource SearchBarBtnTextStyle}" Text="Kiểm tra"/>
                            </StackPanel>
                        </Button>
                        <Button 
                            Margin="5 0 0 0"
                            Width="120"
                            Style="{StaticResource MaterialDesignOutlinedButton}"
                            Command="{Binding ResetDataCommand}">
                            <StackPanel Orientation="Horizontal">
                                <materialDesign:PackIcon Kind="Refresh" />
                                <TextBlock Style="{StaticResource SearchBarBtnTextStyle}" Text="Hủy bỏ"/>
                            </StackPanel>
                        </Button>
                    </StackPanel>
                </Grid>
                <Grid 
                    Grid.Row="2"
                    Margin="0 10 0 0">
                    <StackPanel
                    Orientation="Horizontal">
                        <RadioButton
                            x:Name="RbSettlementVoucherDetail"
                            Style="{StaticResource MaterialDesignTabRadioButton}"
                            IsChecked="{Binding TabIndex, Converter={StaticResource EnumToBoolConverter}, ConverterParameter={x:Static localEnum:ImportTabIndex.DataDetail}}"
                            GroupName="TabIndex"
                            Content="Thông tin chứng từ" />
                        <RadioButton
                            x:Name="RbMLNS"
                            Style="{StaticResource MaterialDesignTabRadioButton}"
                            IsChecked="{Binding TabIndex, Converter={StaticResource EnumToBoolConverter}, ConverterParameter={x:Static localEnum:ImportTabIndex.MLNS}}"
                            GroupName="TabIndex"
                            Content="Mục lục ngân sách" />
                    </StackPanel>
                </Grid>
                <Grid
                    Grid.Row="3"
                    Margin="0 5 0 0">
                    <StackPanel
                        Visibility="{Binding VisibilityDataGridRealBudget}">
                        <DataGrid
                            MaxHeight="750"
                            Visibility="{Binding IsChecked, ElementName=RbSettlementVoucherDetail, Converter={StaticResource BooleanToVisibilityConverter}}"
                            AutoGenerateColumns="False" 
                            CanUserResizeColumns="True"
                            BorderThickness="1"
                            HorizontalScrollBarVisibility="Auto"
                            FrozenColumnCount ="2"
                            CanUserAddRows="False"
                            IsReadOnly="False"
                            GridLinesVisibility="All"
                            ItemsSource="{Binding SettlementVoucherRealDetails}"
                            SelectedItem="{Binding SelectedSettlementRealVoucherDetailsItem}">
                            <DataGrid.Columns>
                                <DataGridTemplateColumn Header="Trạng thái">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <ContentControl x:Name="content"/>
                                            <DataTemplate.Triggers>
                                                <DataTrigger Binding="{Binding ImportStatus}" Value="True">
                                                    <Setter TargetName="content" Property="ContentTemplate">
                                                        <Setter.Value>
                                                            <DataTemplate>
                                                                <materialDesign:PackIcon Kind="CheckCircle" Foreground="Green" HorizontalAlignment="Center"/>
                                                            </DataTemplate>
                                                        </Setter.Value>
                                                    </Setter>
                                                </DataTrigger>
                                                <DataTrigger Binding="{Binding ImportStatus}" Value="False">
                                                    <Setter TargetName="content" Property="ContentTemplate">
                                                        <Setter.Value>
                                                            <DataTemplate>
                                                                <materialDesign:PackIcon Kind="CloseCircle" Foreground="Red" HorizontalAlignment="Center"/>
                                                            </DataTemplate>
                                                        </Setter.Value>
                                                    </Setter>
                                                </DataTrigger>
                                            </DataTemplate.Triggers>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTextColumn Header="Mô tả" Binding="{Binding Description}"/>
                                <DataGridTextColumn Header="LNS" Binding="{Binding LNS, UpdateSourceTrigger=LostFocus}"/>
                                <DataGridTextColumn Header="L" Binding="{Binding L, UpdateSourceTrigger=LostFocus}"/>
                                <DataGridTextColumn Header="K" Binding="{Binding K, UpdateSourceTrigger=LostFocus}"/>
                                <DataGridTextColumn Header="M" Binding="{Binding M, UpdateSourceTrigger=LostFocus}"/>
                                <DataGridTextColumn Header="TM" Binding="{Binding TM, UpdateSourceTrigger=LostFocus}"/>
                                <DataGridTextColumn Header="TTM" Binding="{Binding TTM, UpdateSourceTrigger=LostFocus}"/>
                                <DataGridTextColumn Header="NG" Binding="{Binding NG, UpdateSourceTrigger=LostFocus}"/>
                                <!--<DataGridTextColumn 
                                    Header="Số tiền" 
                                    Binding="{Binding SelfPaymentSettlement, StringFormat={}{0:N0}, UpdateSourceTrigger=LostFocus}"
                                    ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"/>-->

                                <DataGridTextColumn x:Name="SoTienDeNghi"
                                        Header="Đề nghị"
                                        Binding="{Binding SoTienDeNghi, UpdateSourceTrigger=PropertyChanged, StringFormat={}{0:N0}}"
                                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                                        EditingElementStyle="{StaticResource DataGridTextColumnEditingStyle}"
                                        HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}">
                                    <DataGridColumn.HeaderTemplate>
                                        <DataTemplate>
                                            <Grid>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition />
                                                    <RowDefinition />
                                                </Grid.RowDefinitions>
                                                <Border Padding="{Binding RelativeSource={RelativeSource Self}, Path=(wpf:DataGridAssist.ColumnHeaderPadding), Converter={StaticResource HeaderPaddingConverter}}">
                                                    <Canvas Height="{Binding ElementName=HeaderGroup, Path=ActualHeight}">
                                                        <Grid>
                                                            <Grid.Style>
                                                                <Style TargetType="Grid">
                                                                    <Setter Property="Width">
                                                                        <Setter.Value>
                                                                            <MultiBinding Converter="{StaticResource MultipleWidthConverter}">
                                                                                <Binding ElementName="SoTienDeNghi"
                                                                             Path="ActualWidth" />
                                                                                <Binding ElementName="SoTien"
                                                                             Path="ActualWidth" />
                                                                            </MultiBinding>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </Style>
                                                            </Grid.Style>
                                                            <TextBlock HorizontalAlignment="Center"
                                                           Text="Số tiền" />
                                                        </Grid>
                                                    </Canvas>
                                                </Border>
                                                <Border Grid.Row="1"
                                            Padding="{Binding RelativeSource={RelativeSource Self}, Path=(wpf:DataGridAssist.ColumnHeaderPadding)}"
                                            BorderThickness="0 1 1 0"
                                            BorderBrush="{Binding HorizontalGridLinesBrush, RelativeSource={RelativeSource AncestorType=DataGrid}}">
                                                    <TextBlock  HorizontalAlignment="Center"
                                                    Name="HeaderGroup"
                                                    Text="Đề nghị" />
                                                </Border>
                                            </Grid>
                                        </DataTemplate>
                                    </DataGridColumn.HeaderTemplate>
                                </DataGridTextColumn>
                                <component:DataGridTextColumn x:Name="SoTien"
                                              Header="Phê Duyệt"
                                              StringFormat="{}{0:N0}"
                                              Binding="{Binding SelfPaymentSettlement, UpdateSourceTrigger=PropertyChanged, StringFormat={}{0:N0}}"
                                              ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                                              EditingElementStyle="{StaticResource DataGridTextColumnEditingRightCell}"
                                              HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}">
                                    <DataGridColumn.HeaderTemplate>
                                        <DataTemplate>
                                            <Grid>
                                                <Grid.RowDefinitions>
                                                    <RowDefinition />
                                                    <RowDefinition />
                                                </Grid.RowDefinitions>
                                                <Border BorderThickness="0 0 1 0"
                                            BorderBrush="{Binding HorizontalGridLinesBrush, RelativeSource={RelativeSource AncestorType=DataGrid}}"
                                            Padding="{Binding RelativeSource={RelativeSource Self}, Path=(wpf:DataGridAssist.ColumnHeaderPadding), Converter={StaticResource HeaderPaddingConverter}}">
                                                    <Canvas Height="{Binding ElementName=HeaderGroup, Path=ActualHeight}">
                                                    </Canvas>
                                                </Border>
                                                <Border Grid.Row="1"
                                            Padding="{Binding RelativeSource={RelativeSource Self}, Path=(wpf:DataGridAssist.ColumnHeaderPadding)}"
                                            BorderThickness="0 1 1 0"
                                            BorderBrush="{Binding HorizontalGridLinesBrush, RelativeSource={RelativeSource AncestorType=DataGrid}}">
                                                    <TextBlock  HorizontalAlignment="Center"
                                                    Name="HeaderGroup"
                                                    Text="Phê duyệt" />
                                                </Border>
                                            </Grid>
                                        </DataTemplate>
                                    </DataGridColumn.HeaderTemplate>
                                </component:DataGridTextColumn>

                                <!--<DataGridTextColumn 
                                    Header="Tổng số chi phí" 
                                    Binding="{Binding TongSoChiPhi, StringFormat={}{0:N0}, UpdateSourceTrigger=LostFocus}"
                                    ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"/>
                                <DataGridTextColumn 
                                    Header="Tổng số QTNS" 
                                    Binding="{Binding TongSoQTNS, StringFormat={}{0:N0}, UpdateSourceTrigger=LostFocus}"
                                    ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"/>
                                <DataGridTextColumn 
                                    Header="Khấu hao TSCĐ" 
                                    Binding="{Binding KhauHaoTSTD, StringFormat={}{0:N0}, UpdateSourceTrigger=LostFocus}"
                                    ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"/>
                                <DataGridTextColumn 
                                    Header="Tiền lương" 
                                    Binding="{Binding TienLuong, StringFormat={}{0:N0}, UpdateSourceTrigger=LostFocus}"
                                    ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"/>
                                <DataGridTextColumn 
                                    Header="QTNS Khác" 
                                    Binding="{Binding QtnsKhac, StringFormat={}{0:N0}, UpdateSourceTrigger=LostFocus}"
                                    ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"/>
                                <DataGridTextColumn 
                                    Header="Chi phí khác" 
                                    Binding="{Binding ChiPhiKhac, StringFormat={}{0:N0}, UpdateSourceTrigger=LostFocus}"
                                    ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"/>
                                <DataGridTextColumn 
                                    Header="Tổng nộp NSNN" 
                                    Binding="{Binding TongNopNSNN, StringFormat={}{0:N0}, UpdateSourceTrigger=LostFocus}"
                                    ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"/>
                                <DataGridTextColumn 
                                    Header="Thuế GTGT" 
                                    Binding="{Binding ThueGTGT, StringFormat={}{0:N0}, UpdateSourceTrigger=LostFocus}"
                                    ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"/>
                                <DataGridTextColumn 
                                    Header="Thuế TNDN" 
                                    Binding="{Binding ThueTNDN, StringFormat={}{0:N0}, UpdateSourceTrigger=LostFocus}"
                                    ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"/>
                                <DataGridTextColumn 
                                    Header="Thuế Tndn Nộp qua BQP" 
                                    Binding="{Binding ThueTndnNopQuaBQP, StringFormat={}{0:N0}, UpdateSourceTrigger=LostFocus}"
                                    ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"/>
                                <DataGridTextColumn 
                                    Header="Phí/Lệ phí" 
                                    Binding="{Binding PhiLePhi, StringFormat={}{0:N0}, UpdateSourceTrigger=LostFocus}"
                                    ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"/>
                                <DataGridTextColumn 
                                    Header="NSNN khác" 
                                    Binding="{Binding NsnnKhac, StringFormat={}{0:N0}, UpdateSourceTrigger=LostFocus}"
                                    ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"/>
                                <DataGridTextColumn 
                                    Header="Nsnn khác nộp qua BQP" 
                                    Binding="{Binding NsnnKhacNopQuaBQP, StringFormat={}{0:N0}, UpdateSourceTrigger=LostFocus}"
                                    ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"/>
                                <DataGridTextColumn 
                                    Header="Chênh lệch" 
                                    Binding="{Binding ChenhLech, StringFormat={}{0:N0}, UpdateSourceTrigger=LostFocus}"
                                    ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"/>
                                <DataGridTextColumn 
                                    Header="Nộp NSQP" 
                                    Binding="{Binding NopNSQP, StringFormat={}{0:N0}, UpdateSourceTrigger=LostFocus}"
                                    ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"/>
                                <DataGridTextColumn 
                                    Header="Bổ sung kinh phí" 
                                    Binding="{Binding BoSungKinhPhi, StringFormat={}{0:N0}, UpdateSourceTrigger=LostFocus}"
                                    ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"/>
                                <DataGridTextColumn 
                                    Header="Trích các quỹ" 
                                    Binding="{Binding PpTrichCacQuy, StringFormat={}{0:N0}, UpdateSourceTrigger=LostFocus}"
                                    ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"/>
                                <DataGridTextColumn 
                                    Header="Chưa phân phối" 
                                    Binding="{Binding ChuaPhanPhoi, StringFormat={}{0:N0}, UpdateSourceTrigger=LostFocus}"
                                    ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"/>-->
                                <DataGridTextColumn Header="Ghi chú" Binding="{Binding GhiChu, UpdateSourceTrigger=LostFocus}"/>
                                <DataGridTemplateColumn Header="Lỗi">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <ContentControl x:Name="Function"/>
                                            <DataTemplate.Triggers>
                                                <DataTrigger Binding="{Binding ImportStatus}" Value="False">
                                                    <Setter TargetName="Function" Property="ContentTemplate">
                                                        <Setter.Value>
                                                            <DataTemplate>
                                                                <Button
                                                                    Style="{StaticResource MaterialDesignIconButton}"
                                                                    ToolTip="Xem thông tin lỗi"
                                                                    Width="25"
                                                                    Height="25"
                                                                    Command="{Binding Path=DataContext.ShowErrorCommand, RelativeSource= {RelativeSource FindAncestor, AncestorType={x:Type DataGrid}}}">
                                                                    <materialDesign:PackIcon
                                                                        Foreground="DarkRed"
                                                                        Width="15"
                                                                        Height="15"
                                                                        Kind="EyeRemove"/>
                                                                </Button>
                                                            </DataTemplate>
                                                        </Setter.Value>
                                                    </Setter>
                                                </DataTrigger>
                                            </DataTemplate.Triggers>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                                <DataGridTemplateColumn Header="MLNS">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <ContentControl x:Name="Function"/>
                                            <DataTemplate.Triggers>
                                                <DataTrigger Binding="{Binding IsErrorMLNS}" Value="True">
                                                    <Setter TargetName="Function" Property="ContentTemplate">
                                                        <Setter.Value>
                                                            <DataTemplate>
                                                                <Button
                                                                    Style="{StaticResource MaterialDesignIconButton}"
                                                                    ToolTip="Thêm mục lục ngân sách"
                                                                    Width="25"
                                                                    Height="25"
                                                                    Command="{Binding Path=DataContext.AddMLNSCommand, RelativeSource= {RelativeSource FindAncestor, AncestorType={x:Type DataGrid}}}">
                                                                    <materialDesign:PackIcon
                                                                        Foreground="Green"
                                                                        Width="15"
                                                                        Height="15"
                                                                        Kind="FileMoveOutline"/>
                                                                </Button>
                                                            </DataTemplate>
                                                        </Setter.Value>
                                                    </Setter>
                                                </DataTrigger>
                                            </DataTemplate.Triggers>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                    </StackPanel>

                    <Grid Visibility="{Binding IsChecked, ElementName=RbMLNS, Converter={StaticResource BooleanToVisibilityConverter}}">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*"></RowDefinition>
                            <RowDefinition Height="Auto"></RowDefinition>
                            <RowDefinition Height="2*"></RowDefinition>
                        </Grid.RowDefinitions>
                        <DataGrid
                            Visibility="{Binding VisibilityLH}"
                            Grid.Row="0" 
                            Style="{StaticResource MaterialDesignDataGrid}"
                            CellStyle="{StaticResource GenericDataGridCellDetail}"
                            RowStyle="{StaticResource GenericDataGridRowDetail}"
                            ItemsSource="{Binding ImportedMlns}"  
                            AutoGenerateColumns="False" 
                            CanUserResizeColumns="True"
                            BorderThickness="1"
                            HorizontalScrollBarVisibility="Auto"
                            FrozenColumnCount ="3"
                            CanUserAddRows="False"
                            EnableRowVirtualization="True"
                            GridLinesVisibility="All">
                            <DataGrid.Columns>
                                <DataGridCheckBoxColumn 
                                    Width="Auto" 
                                    Header="" 
                                    Binding="{Binding IsSelected, UpdateSourceTrigger=PropertyChanged}"
                                    ElementStyle="{StaticResource MaterialDesignDataGridCheckBoxColumnStyle}"
                                    EditingElementStyle="{StaticResource MaterialDesignDataGridCheckBoxColumnEditingStyle}"/>
                                <DataGridTextColumn Width="Auto" Header="LNS" Binding="{Binding Lns}" IsReadOnly="True"/>
                                <DataGridTextColumn Width="*" Header="Mô tả" Binding="{Binding MoTa}" IsReadOnly="True"/>
                            </DataGrid.Columns>
                        </DataGrid>
                        <StackPanel Visibility="{Binding VisibilityMLNS}" Margin="0 10" Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Left">
                            <Button IsEnabled="{Binding IsEnabledMergeBtn}" Width="100" Style="{StaticResource SearchBarBtnStyle}" ToolTip="Thêm mới" Command="{Binding MergeCommand}">
                                <StackPanel Orientation="Horizontal">
                                    <materialDesign:PackIcon Kind="Download" />
                                    <TextBlock Style="{StaticResource SearchBarBtnTextStyle}" Text="Thêm mới"></TextBlock>
                                </StackPanel>
                            </Button>
                            <Button IsEnabled="{Binding IsEnabledUnmergeCommand}" Width="100" Style="{StaticResource SearchBarBtnStyle}" ToolTip="Loại bỏ" Command="{Binding UnmergeCommand}">
                                <StackPanel Orientation="Horizontal">
                                    <materialDesign:PackIcon Kind="Upload" />
                                    <TextBlock Style="{StaticResource SearchBarBtnTextStyle}" Text="Loại bỏ"></TextBlock>
                                </StackPanel>
                            </Button>
                            <Button IsEnabled="{Binding IsEnableSaveMLNS}" Width="100" Style="{StaticResource SearchBarBtnStyle}" ToolTip="Lưu MLNS" Command="{Binding SaveMLNSCommand}">
                                <StackPanel Orientation="Horizontal">
                                    <materialDesign:PackIcon Kind="ContentSave" />
                                    <TextBlock Style="{StaticResource SearchBarBtnTextStyle}" Text="Lưu MLNS"></TextBlock>
                                </StackPanel>
                            </Button>
                        </StackPanel>

                        <StackPanel Visibility="{Binding VisibilityLH}" Margin="0 10" Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Left">
                            <Button IsEnabled="{Binding IsEnabledMergeLhBtn}" Width="100" Style="{StaticResource SearchBarBtnStyle}" ToolTip="Thêm mới" Command="{Binding MergeCommand}">
                                <StackPanel Orientation="Horizontal">
                                    <materialDesign:PackIcon Kind="Download" />
                                    <TextBlock Style="{StaticResource SearchBarBtnTextStyle}" Text="Thêm mới"></TextBlock>
                                </StackPanel>
                            </Button>
                            <Button IsEnabled="{Binding IsEnabledUnmergeLhCommand}" Width="100" Style="{StaticResource SearchBarBtnStyle}" ToolTip="Loại bỏ" Command="{Binding UnmergeCommand}">
                                <StackPanel Orientation="Horizontal">
                                    <materialDesign:PackIcon Kind="Upload" />
                                    <TextBlock Style="{StaticResource SearchBarBtnTextStyle}" Text="Loại bỏ"></TextBlock>
                                </StackPanel>
                            </Button>
                            <Button IsEnabled="{Binding IsEnableSaveLh}" Width="100" Style="{StaticResource SearchBarBtnStyle}" ToolTip="Lưu MLNS" Command="{Binding SaveMLNSCommand}">
                                <StackPanel Orientation="Horizontal">
                                    <materialDesign:PackIcon Kind="ContentSave" />
                                    <TextBlock Style="{StaticResource SearchBarBtnTextStyle}" Text="Lưu MLNS"></TextBlock>
                                </StackPanel>
                            </Button>
                        </StackPanel>
                        <DataGrid 
                            Visibility="{Binding VisibilityLH}"
                            Grid.Row="2" 
                            Style="{StaticResource MaterialDesignDataGrid}"
                            CellStyle="{StaticResource GenericDataGridCellDetail}"
                            RowStyle="{StaticResource GenericDataGridRowDetail}"
                            VerticalAlignment="Top" 
                            ItemsSource="{Binding ExistedMlns}"  
                            AutoGenerateColumns="False" 
                            CanUserResizeColumns="True"
                            BorderThickness="1"
                            HorizontalScrollBarVisibility="Auto"
                            FrozenColumnCount ="3"
                            CanUserAddRows="False"
                            SelectedItem="{Binding SelectedParent, UpdateSourceTrigger=PropertyChanged}"
                            EnableRowVirtualization="True"
                            GridLinesVisibility="All">
                            <DataGrid.Resources>
                                <Style TargetType="CheckBox" x:Key="style">
                                    <Style.Triggers>
                                        <MultiDataTrigger>
                                            <MultiDataTrigger.Conditions>
                                                <Condition Binding="{Binding IsModified}" Value="false"/>
                                            </MultiDataTrigger.Conditions>
                                            <Setter Property="IsEnabled" Value="False"/>
                                        </MultiDataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </DataGrid.Resources>
                            <DataGrid.Columns>
                                <DataGridCheckBoxColumn 
                                    Width="Auto" 
                                    Header="" 
                                    Binding="{Binding IsSelected, UpdateSourceTrigger=PropertyChanged}"
                                    ElementStyle="{StaticResource MaterialDesignDataGridCheckBoxColumnStyle}"
                                    EditingElementStyle="{StaticResource MaterialDesignDataGridCheckBoxColumnEditingStyle}"/>
                                <DataGridTextColumn Width="Auto" Header="LNS" Binding="{Binding Lns}" IsReadOnly="True"/>
                                <DataGridTextColumn Width="Auto" Header="L" Binding="{Binding L}" IsReadOnly="True"/>
                                <DataGridTextColumn Width="Auto" Header="K" Binding="{Binding K}" IsReadOnly="True"/>
                                <DataGridTextColumn Width="Auto" Header="M" Binding="{Binding M}" IsReadOnly="True"/>
                                <DataGridTextColumn Width="Auto" Header="TM" Binding="{Binding TM}" IsReadOnly="True"/>
                                <DataGridTextColumn Width="Auto" Header="TTM" Binding="{Binding TTM}" IsReadOnly="True"/>
                                <DataGridTextColumn Width="Auto" Header="NG" Binding="{Binding NG}" IsReadOnly="True"/>
                                <DataGridTextColumn Width="Auto" Header="TNG" Binding="{Binding TNG}" IsReadOnly="True"/>
                                <DataGridTextColumn Width="*" Header="Mô tả" Binding="{Binding MoTa}" IsReadOnly="True"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Grid>
                </Grid>
            </Grid>
            <StackPanel Grid.Row="3" Orientation="Horizontal" Margin="0 15 0 0" HorizontalAlignment="Right">
                <Button 
                    IsDefault="True"
                    Margin="5 0 0 0"
                    IsEnabled="{Binding IsSaveData}"
                    Style="{StaticResource MaterialDesignRaisedButton}"
                    Command="{Binding SaveCommand}">
                    <StackPanel Orientation="Horizontal">
                        <materialDesign:PackIcon Kind="ContentSave" />
                        <TextBlock Style="{StaticResource SearchBarBtnTextStyle}" Text="Lưu dữ liệu"/>
                    </StackPanel>
                </Button>
                <Button
                    IsCancel="True"
                    Margin="5 0 0 0"
                    Style="{StaticResource MaterialDesignOutlinedButton}"
                    Command="{Binding CloseCommand}"
                    CommandParameter="{Binding ElementName=RevenueExpenditureImportWindow}">
                    <StackPanel Orientation="Horizontal">
                        <materialDesign:PackIcon Kind="CloseOutline" />
                        <TextBlock Style="{StaticResource SearchBarBtnTextStyle}" Text="Đóng"/>
                    </StackPanel>
                </Button>
            </StackPanel>
        </Grid>
    </Grid>
</Window>
