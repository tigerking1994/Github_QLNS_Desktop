<Window x:Class="VTS.QLNS.CTC.App.View.Forex.ForeignTrade.ContractorPackage.ContractorPackageDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:VTS.QLNS.CTC.App.View.Forex.ForeignTrade.ContractorPackage"
        mc:Ignorable="d"
        xmlns:system="clr-namespace:System;assembly=mscorlib"
        xmlns:localEnum="clr-namespace:VTS.QLNS.CTC.Utility.Enum;assembly=VTS.QLNS.CTC.Utility"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        xmlns:wpf="clr-namespace:MaterialDesignThemes.Wpf;assembly=MaterialDesignThemes.Wpf"
        xmlns:ext="clr-namespace:VTS.QLNS.CTC.App.Extensions"
        xmlns:helper="clr-namespace:VTS.QLNS.CTC.App.Helper"
        xmlns:component="clr-namespace:VTS.QLNS.CTC.App.Component"
        xmlns:custom="clr-namespace:VTS.QLNS.CTC.Custom;assembly=VTS.QLNS.CTC.Custom"
        WindowStartupLocation="CenterScreen"
        WindowState="Maximized"
        Style="{StaticResource MaterialDesignWindow}"
        Title="{Binding Title}">
    <Window.InputBindings>
        <KeyBinding Key="F6" Command="{Binding AddTiGiaCommand}" />
    </Window.InputBindings>
    <materialDesign:DialogHost
        Identifier="ContractInfoDialog"
        DialogTheme="Inherit">
        <Grid Margin="16">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <StackPanel Grid.Row="0">
                <DockPanel>
                    <materialDesign:PackIcon Kind="PlaylistPlus" Style="{StaticResource DialogScreenIconStyle}"/>
                    <StackPanel Orientation="Vertical" VerticalAlignment="Center" Margin="10 0">
                        <TextBlock Text="{Binding Title}" FontWeight="Bold"></TextBlock>
                        <TextBlock Text="{Binding Description}"></TextBlock>
                    </StackPanel>
                </DockPanel>
                <Separator Background="{DynamicResource MaterialDesignDivider}"/>
            </StackPanel>

            <ScrollViewer
                Grid.Row="1" 
                Margin="-4 0" 
                VerticalScrollBarVisibility="Auto" 
                HorizontalScrollBarVisibility="Disabled">
                <Grid  IsEnabled="{Binding IsDetail, Converter={StaticResource InvertBooleanConverter}}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="1*" MinWidth="100"/>
                        <ColumnDefinition Width="1*" MinWidth="100"/>
                        <ColumnDefinition Width="2*" MinWidth="480"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <Grid.Resources>
                        <Style TargetType="custom:AutoCompleteComboBox" BasedOn="{StaticResource MaterialDesignFloatingHintComboBox}">
                            <Setter Property="materialDesign:HintAssist.IsFloating" Value="True" />
                            <Setter Property="Margin" Value="4 2 4 2" />
                            <Setter Property="HorizontalAlignment" Value="Stretch" />
                            <Setter Property="VerticalAlignment" Value="Center" />
                        </Style>

                        <Style TargetType="ComboBox" BasedOn="{StaticResource MaterialDesignFloatingHintComboBox}">
                            <Setter Property="materialDesign:HintAssist.IsFloating" Value="True" />
                            <Setter Property="Margin" Value="4 2 4 2" />
                            <Setter Property="HorizontalAlignment" Value="Stretch" />
                            <Setter Property="VerticalAlignment" Value="Center" />
                        </Style>
                        <Style TargetType="TextBox" BasedOn="{StaticResource MaterialDesignTextBox}">
                            <Setter Property="materialDesign:HintAssist.IsFloating" Value="True" />
                            <Setter Property="Margin" Value="4 2 4 2" />
                            <Setter Property="VerticalAlignment" Value="Center" />
                        </Style>

                        <Style TargetType="DatePicker" BasedOn="{StaticResource MaterialDesignFloatingHintDatePicker}">
                            <Setter Property="materialDesign:HintAssist.IsFloating" Value="True" />
                            <Setter Property="Margin" Value="4 2 4 2" />
                            <Setter Property="HorizontalAlignment" Value="Stretch" />
                            <Setter Property="VerticalAlignment" Value="Center" />
                        </Style>
                    </Grid.Resources>

                    <TextBlock Grid.Row="0" Margin="4 5 5 4" FontWeight="SemiBold">THÔNG TIN PHÊ DUYỆT</TextBlock>

                    <custom:AutoCompleteComboBox
                        Grid.Row="1"
                        Grid.Column="0"
                        Grid.ColumnSpan="1"
                        materialDesign:HintAssist.Hint ="Loại kế hoạch tổng thể"
                        ItemsSource="{Binding LoaiKeHoachTongThe}"
                        DisplayMemberPath="DisplayItem"
                        SelectedItem="{Binding SelectedKeHoachTongThe}"
                        TextSearch.TextPath="DisplayItem"
                        IsEnabled="{Binding IsUpDate, Converter={StaticResource InvertBooleanConverter}}">
                    </custom:AutoCompleteComboBox>

                    <custom:AutoCompleteComboBox
                        Grid.Row="1"
                        Grid.Column="1"
                        Grid.ColumnSpan="1"
                        materialDesign:HintAssist.Hint ="Số kế hoạch tổng thể BQP"
                        ItemsSource="{Binding ItemsSoKHTongThe}"
                        SelectedItem="{Binding SelectedSoKhTongThe}"
                        DisplayMemberPath="SSoKeHoachBqp"
                        TextSearch.TextPath="SSoKeHoachBqp"
                        IsEnabled="{Binding IsUpDate, Converter={StaticResource InvertBooleanConverter}}">
                    </custom:AutoCompleteComboBox>

                    <custom:AutoCompleteComboBox
                        Grid.Row="2"
                        Grid.Column="0"
                        Grid.ColumnSpan="1"
                        materialDesign:HintAssist.Hint ="Đơn vị quản lý"
                        ItemsSource="{Binding ItemsDonVi}"
                        SelectedItem="{Binding SelectedDonVi}"
                        DisplayMemberPath="DisplayMemberPath"
                        TextSearch.TextPath="DisplayMemberPath"
                        IsEnabled="{Binding IsUpDate, Converter={StaticResource InvertBooleanConverter}}">
                    </custom:AutoCompleteComboBox>

                    <TextBox
                        Grid.Row="3"
                        Grid.Column="0"
                        IsEnabled ="False"
                        Text="Nhiệm vụ chi mua sắm"
                        materialDesign:HintAssist.Hint ="Loại nhiệm vụ chi">
                    </TextBox>

                    <custom:AutoCompleteComboBox
                        Grid.Row="3"
                        Grid.Column="1"
                        Grid.ColumnSpan="1"
                        materialDesign:HintAssist.Hint ="Tên nhiệm vụ chi"
                        ItemsSource="{Binding ItemsTenNHiemVuChi}"
                        SelectedItem="{Binding SelectedTenNhiemVuChi}"
                        DisplayMemberPath="DisplayItem"
                        TextSearch.TextPath="DisplayItem"
                        IsEnabled="{Binding IsUpDate, Converter={StaticResource InvertBooleanConverter}}">
                    </custom:AutoCompleteComboBox>

                    <custom:AutoCompleteComboBox
                        Grid.Row="4"
                        Grid.Column="0"
                        Grid.ColumnSpan="1"
                        materialDesign:HintAssist.Hint ="Loại sở cứ"
                        ItemsSource="{Binding ItemsLoaiSoCu}"
                        SelectedItem="{Binding SelectedLoaiSoCu}"
                        DisplayMemberPath="DisplayItem"
                        TextSearch.TextPath="DisplayItem"
                        IsEnabled="{Binding IsUpDate, Converter={StaticResource InvertBooleanConverter}}">
                    </custom:AutoCompleteComboBox>

                    <custom:AutoCompleteComboBox
                        Grid.Row="4"
                        Grid.Column="1"
                        Grid.ColumnSpan="1"
                        materialDesign:HintAssist.Hint ="Số quyết định sở cứ"
                        ItemsSource="{Binding ItemsSoQuyetDinhSoCu}"
                        SelectedItem="{Binding SoQuyetDinhSoCuSelected}"
                        DisplayMemberPath="DisplayItem"
                        TextSearch.TextPath="DisplayItem"
                        IsEnabled="{Binding IsUpDate, Converter={StaticResource InvertBooleanConverter}}">
                    </custom:AutoCompleteComboBox>

                    <TextBox
                        Grid.Row="5"
                        Grid.Column="0"
                        Grid.ColumnSpan="1"
                        Text="{Binding Model.SSoQuyetDinh}"
                        materialDesign:HintAssist.Hint ="Số quyết định gói thầu">
                    </TextBox>

                    <DatePicker
                        Language="vi-VN"
                        Grid.Row="5"
                        Grid.Column="1"
                        SelectedDate="{Binding  Model.DNgayQuyetDinh}"
                        materialDesign:HintAssist.Hint ="Ngày ban hành">
                    </DatePicker>

                    <TextBox
                        Grid.Row="6"
                        Grid.Column="0"
                        Grid.ColumnSpan="1"
                        Text="{Binding Model.STenGoiThau}"
                        materialDesign:HintAssist.Hint ="Tên gói thầu">
                    </TextBox>

                    <custom:AutoCompleteComboBox
                        Grid.Row="6"
                        Grid.Column="1"
                        Grid.ColumnSpan="1"
                        materialDesign:HintAssist.Hint ="Hình thức chọn nhà thầu"
                        ItemsSource="{Binding ItemsHinhThucChonNhaThau}"
                        SelectedItem="{Binding SelectedHinhThucChonNhaThau}"
                        DisplayMemberPath="STenHinhThucChonNhaThau"
                        TextSearch.TextPath="STenHinhThucChonNhaThau">
                    </custom:AutoCompleteComboBox>

                    <custom:AutoCompleteComboBox
                        Grid.Row="7"
                        Grid.Column="0"
                        Grid.ColumnSpan="1"
                        materialDesign:HintAssist.Hint ="Phương thức lựa chọn nhà thầu"
                        ItemsSource="{Binding ItemsPhuongThucChonNhaThau}"
                        SelectedItem="{Binding SelectedPhuongThucChonNhaThau}"
                        DisplayMemberPath="STenPhuongThucChonNhaThau"
                        TextSearch.TextPath="STenPhuongThucChonNhaThau">
                    </custom:AutoCompleteComboBox>

                    <custom:AutoCompleteComboBox
                        Grid.Row="7"
                        Grid.Column="1"
                        Grid.ColumnSpan="1"
                        materialDesign:HintAssist.Hint ="Loại hợp đồng"
                        ItemsSource="{Binding ItemsLoaiHopDong}"
                        SelectedItem="{Binding SelectedLoaiHopDong}"
                        DisplayMemberPath="STenLoaiHopDong"
                        TextSearch.TextPath="STenLoaiHopDong">
                    </custom:AutoCompleteComboBox>

                    <DatePicker
                        Language="vi-VN"
                        Grid.Row="8"
                        Grid.Column="0"
                        SelectedDate="{Binding Model.DBatDauChonNhaThau}"
                        materialDesign:HintAssist.Hint ="Thời gian chọn nhà thầu từ">
                    </DatePicker>

                    <DatePicker
                        Language="vi-VN"
                        Grid.Row="8"
                        Grid.Column="1"
                        SelectedDate="{Binding Model.DKetThucChonNhaThau}"
                        materialDesign:HintAssist.Hint ="Thời gian chọn nhà thầu đến">
                    </DatePicker>

                    <TextBox
                        Grid.Row="9"
                        Grid.Column="0"
                        Grid.ColumnSpan="1"
                        Text="{Binding Model.IThoiGianThucHien}"
                        materialDesign:HintAssist.Hint ="Thời gian thực hiện (ngày)">
                    </TextBox>

                    <custom:AutoCompleteComboBox
                        Grid.Row="9"
                        Grid.Column="1"
                        DisplayMemberPath="STenTiGia"
                        TextSearch.TextPath="STenTiGia"
                        materialDesign:HintAssist.Hint="Tỉ giá (*)"
                        SelectedItem="{Binding SelectedTiGia, UpdateSourceTrigger=PropertyChanged}"
                        ItemsSource="{Binding ItemsTiGia}" />

                    <custom:AutoCompleteComboBox
                        Grid.Row="10"
                        Grid.Column="0"
                        DisplayMemberPath="SMaTienTeQuyDoi"
                        TextSearch.TextPath="SMaTienTeQuyDoi"
                        materialDesign:HintAssist.Hint="Mã ngoại tệ khác (*)"
                        SelectedItem="{Binding SelectedTiGiaChiTiet, UpdateSourceTrigger=PropertyChanged}"
                        ItemsSource="{Binding ItemsTiGiaChiTiet}" />

                    <TextBox
                        Grid.Row="11"
                        Grid.Column="0"
                        IsEnabled ="False"
                        Text="{Binding GiaGoiThauUSD, StringFormat={}{0:N2}}"
                        materialDesign:HintAssist.Hint ="Giá gói thầu (USD)">
                    </TextBox>

                    <TextBox
                        Grid.Row="11"
                        Grid.Column="1"
                        IsEnabled ="False"
                        Text="{Binding GiaGoiThauVND, StringFormat={}{0:N0}}"
                        materialDesign:HintAssist.Hint ="Giá gói thầu (VND)">
                    </TextBox>

                    <TextBox
                        Grid.Row="12"
                        Grid.Column="0"
                        IsEnabled ="False"
                        Text="{Binding GiaGoiThauEUR, StringFormat={}{0:N2}}"
                        materialDesign:HintAssist.Hint ="Giá gói thầu (EUR)">
                    </TextBox>

                    <TextBox
                        Grid.Row="12"
                        Grid.Column="1"
                        IsEnabled ="False"
                        Text="{Binding GiaGoiThauNgoaiTeKhac, StringFormat={}{0:N2}}"
                        materialDesign:HintAssist.Hint ="Giá gói thầu (Ngoại tệ khác)">
                    </TextBox>

                    <StackPanel Grid.Row="0" Grid.Column="2" Grid.RowSpan="14" Margin="5 0 0 0">
                        <StackPanel>
                            <StackPanel>
                                <TextBox Margin="0 5 0 0" FontWeight="SemiBold">THÔNG TIN NGUỒN VỐN</TextBox>
                                <Border Margin="0 5 0 0">
                                    <DataGrid
                                        x:Name="dgThongTinNGuonVon"
                                        FrozenColumnCount="1"
                                        BorderThickness="1"
                                        CanUserResizeColumns="True"
                                        HorizontalScrollBarVisibility="Auto"
                                        CanUserAddRows="False"
                                        IsSynchronizedWithCurrentItem="True"
                                        GridLinesVisibility="All"
                                        Width="{Binding RelativeSource={RelativeSource AncestorType={x:Type Border}}, Path=ActualWidth}"
                                        RowStyle="{StaticResource DataGridRowDetail}"
                                        Style="{StaticResource MaterialDesignDataGrid}"
                                        SelectedItem="{Binding SelectedThongTinNguon}"
                                        ItemsSource="{Binding ItemsThongTinNguonVon, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        AutoGenerateColumns="False">
                                        <DataGrid.Resources>
                                            <helper:BindingProxy x:Key="DataContextProxy" Data="{Binding}"/>
                                        </DataGrid.Resources>
                                        <DataGrid.Columns>
                                            <DataGridCheckBoxColumn
                                                x:Name="chbox1"
                                                Width="50"
                                                IsReadOnly="False"
                                                Binding="{Binding IsSelected,UpdateSourceTrigger=PropertyChanged}" 
                                                ElementStyle="{StaticResource MaterialDesignDataGridCheckBoxColumnStyle}"
                                                EditingElementStyle="{StaticResource MaterialDesignDataGridCheckBoxColumnEditingStyle}">
                                                <DataGridCheckBoxColumn.Header>
                                                    <Border Background="Transparent">
                                                        <CheckBox IsChecked="{Binding Data.IsAllNGuonVonItemSelected, UpdateSourceTrigger=PropertyChanged, Source={StaticResource DataContextProxy}}" />
                                                    </Border>
                                                </DataGridCheckBoxColumn.Header>
                                                <DataGridCheckBoxColumn.HeaderStyle>
                                                    <Style
                                                        TargetType="{x:Type DataGridColumnHeader}"
                                                        BasedOn="{StaticResource MaterialDesignDataGridColumnHeader}">
                                                        <Setter Property="HorizontalContentAlignment" Value="Center" />
                                                    </Style>
                                                </DataGridCheckBoxColumn.HeaderStyle>
                                            </DataGridCheckBoxColumn>

                                            <materialDesign:DataGridTextColumn
                                                x:Name="tenNguonVon"
                                                Header="Tên nguồn vốn"
                                                Width="170"
                                                IsReadOnly="True"
                                                Binding="{Binding STenNguonVon}">
                                            </materialDesign:DataGridTextColumn>

                                            <component:DataGridTextColumn 
                                                x:Name="SSoKeHoachTtcp"
                                                Binding="{Binding FGiaTriUsd, StringFormat={}{0:N2}}" 
                                                Header="USD" 
                                                Width="75"
                                                IsReadOnly="True"
                                                StringFormat="{}{0:N0}"
                                                ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                                                HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}">
                                                <DataGridColumn.HeaderTemplate>
                                                    <DataTemplate>
                                                        <Grid>
                                                            <Grid.RowDefinitions>
                                                                <RowDefinition />
                                                                <RowDefinition />
                                                            </Grid.RowDefinitions>
                                                            <Border
                                                                Padding="{Binding RelativeSource={RelativeSource Self}, Path=(wpf:DataGridAssist.ColumnHeaderPadding), Converter={StaticResource HeaderPaddingConverter}}">
                                                                <Canvas Height="{Binding ElementName=HeaderGroup, Path=ActualHeight}">
                                                                    <Grid>
                                                                        <Grid.Style>
                                                                            <Style TargetType="Grid">
                                                                                <Setter Property="Width">
                                                                                    <Setter.Value>
                                                                                        <MultiBinding Converter="{StaticResource MultipleWidthConverter}">
                                                                                            <Binding ElementName="SSoKeHoachTtcp" Path="ActualWidth"/>
                                                                                            <Binding ElementName="DNgayKeHoachTtcp" Path="ActualWidth"/>
                                                                                            <Binding ElementName="EUR" Path="ActualWidth"/>
                                                                                            <Binding ElementName="NgoaiTe" Path="ActualWidth"/>
                                                                                        </MultiBinding>
                                                                                    </Setter.Value>
                                                                                </Setter>
                                                                            </Style>
                                                                        </Grid.Style>
                                                                        <TextBlock HorizontalAlignment="Center" Text="Giá trị sở cứ được duyệt"/>
                                                                    </Grid>
                                                                </Canvas>
                                                            </Border>
                                                            <Border
                                                                Grid.Row="1"
                                                                Padding="{Binding RelativeSource={RelativeSource Self}, Path=(wpf:DataGridAssist.ColumnHeaderPadding)}"
                                                                BorderThickness="0 1 1 0"
                                                                BorderBrush="{Binding HorizontalGridLinesBrush, RelativeSource={RelativeSource AncestorType=DataGrid}}">
                                                                <TextBlock Name="HeaderGroup" Text="{Binding}"/>
                                                            </Border>
                                                        </Grid>
                                                    </DataTemplate>
                                                </DataGridColumn.HeaderTemplate>
                                            </component:DataGridTextColumn>
                                            <component:DataGridTextColumn 
                                                x:Name="DNgayKeHoachTtcp"
                                                Binding="{Binding FGiaTriVnd, StringFormat={}{0:N0}}" 
                                                Header="VND"
                                                Width="120"
                                                IsReadOnly="True"
                                                HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                                                StringFormat="{}{0:N0}"
                                                EditingElementStyle="{StaticResource DataGridTextColumnEditingStyle}" 
                                                HeaderTemplate="{StaticResource CenterHeader}"/>
                                            <component:DataGridTextColumn 
                                                x:Name="EUR"
                                                Binding="{Binding FGiaTriEur, StringFormat={}{0:N2}}" 
                                                Header="EUR"
                                                IsReadOnly="True"
                                                EditingElementStyle="{StaticResource DataGridTextColumnEditingStyle}" 
                                                StringFormat="{}{0:N0}"
                                                HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                                                HeaderTemplate="{StaticResource CenterHeader}"/>
                                            <component:DataGridTextColumn 
                                                x:Name="NgoaiTe"
                                                Binding="{Binding FGiaTriNgoaiTeKhac, StringFormat={}{0:N2}}" 
                                                Header="Ngoại tệ khác"
                                                IsReadOnly="True"
                                                StringFormat="{}{0:N0}"
                                                EditingElementStyle="{StaticResource DataGridTextColumnEditingStyle}" 
                                                HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                                                HeaderTemplate="{StaticResource RightHeader}"/>

                                            <component:DataGridTextColumn 
                                                x:Name="GoiThauUSD"
                                                Binding="{Binding FGiaTriUSDGoiThau, StringFormat={}{0:N2}, Converter={StaticResource NumberToStringEmptyConverter}}" 
                                                Header="USD" 
                                                Width="75"
                                                StringFormat="{}{0:N0}"
                                                EditingElementStyle="{StaticResource DataGridTextColumnEditingStyle}" 
                                                HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}">
                                                <DataGridColumn.HeaderTemplate>
                                                    <DataTemplate>
                                                        <Grid>
                                                            <Grid.RowDefinitions>
                                                                <RowDefinition />
                                                                <RowDefinition />
                                                            </Grid.RowDefinitions>
                                                            <Border
                                                                Padding="{Binding RelativeSource={RelativeSource Self}, Path=(wpf:DataGridAssist.ColumnHeaderPadding), Converter={StaticResource HeaderPaddingConverter}}">
                                                                <Canvas Height="{Binding ElementName=HeaderGroup, Path=ActualHeight}">
                                                                    <Grid>
                                                                        <Grid.Style>
                                                                            <Style TargetType="Grid">
                                                                                <Setter Property="Width">
                                                                                    <Setter.Value>
                                                                                        <MultiBinding Converter="{StaticResource MultipleWidthConverter}">
                                                                                            <Binding ElementName="GoiThauUSD" Path="ActualWidth"/>
                                                                                            <Binding ElementName="GoiThauVND" Path="ActualWidth"/>
                                                                                            <Binding ElementName="GoiThauEUR" Path="ActualWidth"/>
                                                                                            <Binding ElementName="GoiThauNgoaiTeKhac" Path="ActualWidth"/>
                                                                                        </MultiBinding>
                                                                                    </Setter.Value>
                                                                                </Setter>
                                                                            </Style>
                                                                        </Grid.Style>
                                                                        <TextBlock HorizontalAlignment="Center" Text="Giá trị gói thầu"/>
                                                                    </Grid>
                                                                </Canvas>
                                                            </Border>
                                                            <Border
                                                                Grid.Row="1"
                                                                Padding="{Binding RelativeSource={RelativeSource Self}, Path=(wpf:DataGridAssist.ColumnHeaderPadding)}"
                                                                BorderThickness="0 1 1 0"
                                                                BorderBrush="{Binding HorizontalGridLinesBrush, RelativeSource={RelativeSource AncestorType=DataGrid}}">
                                                                <TextBlock Name="HeaderGroup" Text="{Binding}"/>
                                                            </Border>
                                                        </Grid>
                                                    </DataTemplate>
                                                </DataGridColumn.HeaderTemplate>
                                            </component:DataGridTextColumn>
                                            <component:DataGridTextColumn 
                                                x:Name="GoiThauVND"
                                                Binding="{Binding FGiaTriVNDGoiThau, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}}" 
                                                Header="VND"
                                                Width="120"
                                                StringFormat="{}{0:N0}"
                                                EditingElementStyle="{StaticResource DataGridTextColumnEditingStyle}" 
                                                HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                                                HeaderTemplate="{StaticResource CenterHeader}"/>
                                            <component:DataGridTextColumn 
                                                x:Name="GoiThauEUR"
                                                Binding="{Binding FGiaTriEURGoiThau, StringFormat={}{0:N2}, Converter={StaticResource NumberToStringEmptyConverter}}" 
                                                Header="EUR"
                                                EditingElementStyle="{StaticResource DataGridTextColumnEditingStyle}" 
                                                HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                                                StringFormat="{}{0:N0}"
                                                HeaderTemplate="{StaticResource CenterHeader}"/>
                                            <component:DataGridTextColumn 
                                                x:Name="GoiThauNgoaiTeKhac"
                                                Binding="{Binding FGiaTriNgoaiTeKhacGoiThau, StringFormat={}{0:N2}, Converter={StaticResource NumberToStringEmptyConverter}}" 
                                                Header="Ngoại tệ khác"
                                                EditingElementStyle="{StaticResource DataGridTextColumnEditingStyle}" 
                                                HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                                                StringFormat="{}{0:N0}"
                                                HeaderTemplate="{StaticResource RightHeader}"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Border>

                                <DockPanel>
                                    <Border BorderBrush="{DynamicResource MaterialDesignDivider}"  BorderThickness="1" >
                                        <StackPanel Orientation="Horizontal">
                                            <Grid>
                                                <Grid>
                                                    <Grid.Width>
                                                        <MultiBinding Converter="{StaticResource MultipleWidthConverter}">
                                                            <Binding ElementName="tenNguonVon" Path="ActualWidth"/>
                                                        </MultiBinding>
                                                    </Grid.Width>
                                                    <TextBlock  TextAlignment="Center" FontWeight="Bold" Margin="16 8 16 8" Text="Tổng nguồn vốn :" />
                                                </Grid>
                                            </Grid>
                                            <Grid Width="{Binding ElementName=SSoKeHoachTtcp, Path=ActualWidth}"></Grid>
                                            <Grid Width="{Binding ElementName=DNgayKeHoachTtcp, Path=ActualWidth}"></Grid>
                                            <Grid Width="{Binding ElementName=EUR, Path=ActualWidth}"></Grid>
                                            <Grid Width="{Binding ElementName=NgoaiTe, Path=ActualWidth}"></Grid>
                                            <Grid Width="{Binding ElementName=GoiThauUSD, Path=ActualWidth}">
                                                <TextBlock FontWeight="Bold" Margin="0 8 0 0" TextAlignment="Right" Text="{Binding FGiaTriUSDNguonVon, StringFormat={}{0:N2}}" />
                                            </Grid>
                                            <Grid Width="{Binding ElementName=GoiThauVND, Path=ActualWidth}">
                                                <TextBlock FontWeight="Bold" Margin="5 8 0 0" TextAlignment="Right" Text="{Binding FGiaTriVNDNguonVon, StringFormat={}{0:N0}}" />
                                            </Grid>
                                            <Grid Width="{Binding ElementName=GoiThauEUR, Path=ActualWidth}">
                                                <TextBlock FontWeight="Bold" Margin="5 8 0 0" TextAlignment="Right" Text="{Binding FGiaTriEURNguonVon, StringFormat={}{0:N2}}" />
                                            </Grid>
                                            <Grid Width="{Binding ElementName=GoiThauNgoaiTeKhac, Path=ActualWidth}">
                                                <TextBlock FontWeight="Bold" Margin="5 8 0 0" TextAlignment="Right" Text="{Binding FGiaTriNgoaiTeKhacNguonVon, StringFormat={}{0:N2}}" />
                                            </Grid>
                                        </StackPanel>
                                    </Border>
                                </DockPanel>

                                <DockPanel>
                                    <Border BorderBrush="{DynamicResource MaterialDesignDivider}"  BorderThickness="1" >
                                        <StackPanel Orientation="Horizontal">
                                            <Grid>
                                                <Grid>
                                                    <Grid.Width>
                                                        <MultiBinding Converter="{StaticResource MultipleWidthConverter}">
                                                            <Binding ElementName="tenNguonVon" Path="ActualWidth"/>
                                                        </MultiBinding>
                                                    </Grid.Width>
                                                    <TextBlock  TextAlignment="Center" FontWeight="Bold" Margin="16 8 16 8" Text="Tổng nguồn vốn còn lại :" />
                                                </Grid>
                                            </Grid>
                                            <Grid Width="{Binding ElementName=SSoKeHoachTtcp, Path=ActualWidth}"></Grid>
                                            <Grid Width="{Binding ElementName=DNgayKeHoachTtcp, Path=ActualWidth}"></Grid>
                                            <Grid Width="{Binding ElementName=EUR, Path=ActualWidth}"></Grid>
                                            <Grid Width="{Binding ElementName=NgoaiTe, Path=ActualWidth}"></Grid>
                                            <Grid Width="{Binding ElementName=GoiThauUSD, Path=ActualWidth}">
                                                <TextBlock FontWeight="Bold" Margin="0 8 0 0" TextAlignment="Right" Text="{Binding FGiaTriUSDNguonVonConLai, StringFormat={}{0:N2}}" />
                                            </Grid>
                                            <Grid Width="{Binding ElementName=GoiThauVND, Path=ActualWidth}">
                                                <TextBlock FontWeight="Bold" Margin="5 8 0 0" TextAlignment="Right" Text="{Binding FGiaTriVNDNguonVonConLai, StringFormat={}{0:N0}}" />
                                            </Grid>
                                            <Grid Width="{Binding ElementName=GoiThauEUR, Path=ActualWidth}">
                                                <TextBlock FontWeight="Bold" Margin="5 8 0 0" TextAlignment="Right" Text="{Binding FGiaTriEURNguonVonConLai, StringFormat={}{0:N2}}" />
                                            </Grid>
                                            <Grid Width="{Binding ElementName=GoiThauNgoaiTeKhac, Path=ActualWidth}">
                                                <TextBlock FontWeight="Bold" Margin="5 8 0 0" TextAlignment="Right" Text="{Binding FGiaTriNgoaiTeKhacNguonVonConLai, StringFormat={}{0:N2}}" />
                                            </Grid>
                                        </StackPanel>
                                    </Border>
                                </DockPanel>
                            </StackPanel>

                            <StackPanel>
                                <TextBox Margin="0 15 0 0" FontWeight="SemiBold">THÔNG TIN PHỤ LỤC - CHI PHÍ</TextBox>
                                <Border Margin="0 5 0 0">
                                    <DataGrid
                                        x:Name="dgdThongTinPhuLucChiPhi"
                                        FrozenColumnCount="1"
                                        BorderThickness="1"
                                        CanUserResizeColumns="True"
                                        HorizontalScrollBarVisibility="Auto"
                                        CanUserAddRows="False"
                                        IsSynchronizedWithCurrentItem="True"
                                        GridLinesVisibility="All"
                                        Width="{Binding RelativeSource={RelativeSource AncestorType={x:Type Border}}, Path=ActualWidth}"
                                        RowStyle="{StaticResource DataGridRowDetail}"
                                        Style="{StaticResource MaterialDesignDataGrid}"
                                        SelectedItem="{Binding SelectedThongTinChiPhi}"
                                        ItemsSource="{Binding ItemsThongTinChiPhi, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        AutoGenerateColumns="False">
                                        <DataGrid.Resources>
                                            <helper:BindingProxy x:Key="DataContextProxy" Data="{Binding}"/>
                                        </DataGrid.Resources>
                                        <DataGrid.Columns>
                                            <DataGridCheckBoxColumn
                                                x:Name="chbox"
                                                Width="50"
                                                IsReadOnly="False"
                                                Binding="{Binding IsSelected,UpdateSourceTrigger=PropertyChanged}" 
                                                ElementStyle="{StaticResource MaterialDesignDataGridCheckBoxColumnStyle}"
                                                EditingElementStyle="{StaticResource MaterialDesignDataGridCheckBoxColumnEditingStyle}">
                                                <DataGridCheckBoxColumn.Header>
                                                    <Border Background="Transparent">
                                                        <CheckBox IsChecked="{Binding Data.IsAllChiPhiItemSelected, UpdateSourceTrigger=PropertyChanged, Source={StaticResource DataContextProxy}}" />
                                                    </Border>
                                                </DataGridCheckBoxColumn.Header>
                                                <DataGridCheckBoxColumn.HeaderStyle>
                                                    <Style
                                                        TargetType="{x:Type DataGridColumnHeader}"
                                                        BasedOn="{StaticResource MaterialDesignDataGridColumnHeader}">
                                                        <Setter Property="HorizontalContentAlignment" Value="Center" />
                                                    </Style>
                                                </DataGridCheckBoxColumn.HeaderStyle>
                                            </DataGridCheckBoxColumn>

                                            <materialDesign:DataGridTextColumn
                                                x:Name="tenChiPhi"
                                                Header="Tên chi phí"
                                                Width="170"
                                                IsReadOnly="True"
                                                Binding="{Binding STenChiPhi}">
                                            </materialDesign:DataGridTextColumn>

                                            <component:DataGridTextColumn 
                                                x:Name="SSoKeHoachTtcp3"
                                                Binding="{Binding FGiaTriUsd, StringFormat={}{0:N2}}" 
                                                Header="USD" 
                                                Width="80"
                                                IsReadOnly="True"
                                                ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                                                HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}">
                                                <DataGridColumn.HeaderTemplate>
                                                    <DataTemplate>
                                                        <Grid>
                                                            <Grid.RowDefinitions>
                                                                <RowDefinition />
                                                                <RowDefinition />
                                                            </Grid.RowDefinitions>
                                                            <Border
                                                                Padding="{Binding RelativeSource={RelativeSource Self}, Path=(wpf:DataGridAssist.ColumnHeaderPadding), Converter={StaticResource HeaderPaddingConverter}}">
                                                                <Canvas Height="{Binding ElementName=HeaderGroup, Path=ActualHeight}">
                                                                    <Grid>
                                                                        <Grid.Style>
                                                                            <Style TargetType="Grid">
                                                                                <Setter Property="Width">
                                                                                    <Setter.Value>
                                                                                        <MultiBinding Converter="{StaticResource MultipleWidthConverter}">
                                                                                            <Binding ElementName="SSoKeHoachTtcp3" Path="ActualWidth"/>
                                                                                            <Binding ElementName="DNgayKeHoachTtcp3" Path="ActualWidth"/>
                                                                                            <Binding ElementName="EUR3" Path="ActualWidth"/>
                                                                                            <Binding ElementName="NgoaiTe3" Path="ActualWidth"/>
                                                                                        </MultiBinding>
                                                                                    </Setter.Value>
                                                                                </Setter>
                                                                            </Style>
                                                                        </Grid.Style>
                                                                        <TextBlock HorizontalAlignment="Center" Text="Giá trị sở cứ được duyệt"/>
                                                                    </Grid>
                                                                </Canvas>
                                                            </Border>
                                                            <Border
                                                                Grid.Row="1"
                                                                Padding="{Binding RelativeSource={RelativeSource Self}, Path=(wpf:DataGridAssist.ColumnHeaderPadding)}"
                                                                BorderThickness="0 1 1 0"
                                                                BorderBrush="{Binding HorizontalGridLinesBrush, RelativeSource={RelativeSource AncestorType=DataGrid}}">
                                                                <TextBlock Name="HeaderGroup" Text="{Binding}"/>
                                                            </Border>
                                                        </Grid>
                                                    </DataTemplate>
                                                </DataGridColumn.HeaderTemplate>
                                            </component:DataGridTextColumn>
                                            <component:DataGridTextColumn 
                                                x:Name="DNgayKeHoachTtcp3"
                                                Binding="{Binding FGiaTriVnd, StringFormat={}{0:N0}}" 
                                                Header="VND"
                                                Width="110"
                                                IsReadOnly="True"
                                                ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                                                HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                                                HeaderTemplate="{StaticResource CenterHeader}"/>
                                            <component:DataGridTextColumn 
                                                x:Name="EUR3"
                                                Binding="{Binding FGiaTriEur, StringFormat={}{0:N2}}" 
                                                Header="EUR"
                                                IsReadOnly="True"
                                                ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                                                HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                                                HeaderTemplate="{StaticResource CenterHeader}"/>
                                            <component:DataGridTextColumn 
                                                x:Name="NgoaiTe3"
                                                Binding="{Binding FGiaTriNgoaiTeKhac, StringFormat={}{0:N2}}" 
                                                Header="Ngoại tệ khác"
                                                IsReadOnly="True"
                                                ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                                                HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                                                HeaderTemplate="{StaticResource RightHeader}"/>

                                            <component:DataGridTextColumn 
                                                x:Name="GoiThauChiPhiUSD"
                                                Binding="{Binding FGiaTriUSDGoiThau, StringFormat={}{0:N2}, Converter={StaticResource NumberToStringEmptyConverter}}" 
                                                Header="USD" 
                                                Width="80"
                                                StringFormat="{}{0:N0}"
                                                EditingElementStyle="{StaticResource DataGridTextColumnEditingStyle}" 
                                                HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}">
                                                <DataGridColumn.HeaderTemplate>
                                                    <DataTemplate>
                                                        <Grid>
                                                            <Grid.RowDefinitions>
                                                                <RowDefinition />
                                                                <RowDefinition />
                                                            </Grid.RowDefinitions>
                                                            <Border
                                                                Padding="{Binding RelativeSource={RelativeSource Self}, Path=(wpf:DataGridAssist.ColumnHeaderPadding), Converter={StaticResource HeaderPaddingConverter}}">
                                                                <Canvas Height="{Binding ElementName=HeaderGroup, Path=ActualHeight}">
                                                                    <Grid>
                                                                        <Grid.Style>
                                                                            <Style TargetType="Grid">
                                                                                <Setter Property="Width">
                                                                                    <Setter.Value>
                                                                                        <MultiBinding Converter="{StaticResource MultipleWidthConverter}">
                                                                                            <Binding ElementName="GoiThauChiPhiUSD" Path="ActualWidth"/>
                                                                                            <Binding ElementName="GoiThauChiPhiVND" Path="ActualWidth"/>
                                                                                            <Binding ElementName="GoiThauChiPhiEUR" Path="ActualWidth"/>
                                                                                            <Binding ElementName="GoiThauChiPhiNgoaiTeKhac" Path="ActualWidth"/>
                                                                                        </MultiBinding>
                                                                                    </Setter.Value>
                                                                                </Setter>
                                                                            </Style>
                                                                        </Grid.Style>
                                                                        <TextBlock HorizontalAlignment="Center" Text="Giá trị gói thầu"/>
                                                                    </Grid>
                                                                </Canvas>
                                                            </Border>
                                                            <Border
                                                                Grid.Row="1"
                                                                Padding="{Binding RelativeSource={RelativeSource Self}, Path=(wpf:DataGridAssist.ColumnHeaderPadding)}"
                                                                BorderThickness="0 1 1 0"
                                                                BorderBrush="{Binding HorizontalGridLinesBrush, RelativeSource={RelativeSource AncestorType=DataGrid}}">
                                                                <TextBlock Name="HeaderGroup" Text="{Binding}"/>
                                                            </Border>
                                                        </Grid>
                                                    </DataTemplate>
                                                </DataGridColumn.HeaderTemplate>
                                            </component:DataGridTextColumn>
                                            <component:DataGridTextColumn 
                                                x:Name="GoiThauChiPhiVND"
                                                Binding="{Binding FGiaTriVNDGoiThau, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}}" 
                                                Header="VND"
                                                Width="120"
                                                StringFormat="{}{0:N0}"
                                                EditingElementStyle="{StaticResource DataGridTextColumnEditingStyle}" 
                                                HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                                                HeaderTemplate="{StaticResource CenterHeader}"/>
                                            <component:DataGridTextColumn 
                                                x:Name="GoiThauChiPhiEUR"
                                                Binding="{Binding FGiaTriEURGoiThau, StringFormat={}{0:N2}, Converter={StaticResource NumberToStringEmptyConverter}}" 
                                                Header="EUR"
                                                StringFormat="{}{0:N0}"
                                                EditingElementStyle="{StaticResource DataGridTextColumnEditingStyle}" 
                                                HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                                                HeaderTemplate="{StaticResource CenterHeader}"/>
                                            <component:DataGridTextColumn 
                                                x:Name="GoiThauChiPhiNgoaiTeKhac"
                                                Binding="{Binding FGiaTriNgoaiTeKhacGoiThau, StringFormat={}{0:N2}, Converter={StaticResource NumberToStringEmptyConverter}}" 
                                                Header="Ngoại tệ khác"
                                                StringFormat="{}{0:N0}"
                                                EditingElementStyle="{StaticResource DataGridTextColumnEditingStyle}" 
                                                HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                                                HeaderTemplate="{StaticResource RightHeader}"/>
                                           
                                            <DataGridTemplateColumn MinWidth="50"
                                                 x:Name="ChiTietChiPhi">
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <Button
                                                            Visibility="{Binding IsEditHangMuc, Converter={StaticResource BooleanToVisibilityConverter}}"
                                                            Style="{StaticResource MaterialDesignFlatButton}" FontSize="12" Height="25"
                                                            Command="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Window}}, Path=DataContext.PhuLucHangMucCommand}">Chi tiết hạng mục</Button>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                            </DataGridTemplateColumn>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Border>
                                <DockPanel>
                                    <Border BorderBrush="{DynamicResource MaterialDesignDivider}"  BorderThickness="1" >
                                        <StackPanel Orientation="Horizontal">
                                            <Grid>
                                                <Grid>
                                                    <Grid.Width>
                                                        <MultiBinding Converter="{StaticResource MultipleWidthConverter}">
                                                            <Binding ElementName="tenChiPhi" Path="ActualWidth"/>
                                                        </MultiBinding>
                                                    </Grid.Width>
                                                    <TextBlock  TextAlignment="Center" FontWeight="Bold" Margin="16 8 16 8" Text="Tổng chi phí :" />
                                                </Grid>
                                            </Grid>
                                            <Grid Width="{Binding ElementName=SSoKeHoachTtcp3, Path=ActualWidth}"></Grid>
                                            <Grid Width="{Binding ElementName=DNgayKeHoachTtcp3, Path=ActualWidth}"></Grid>
                                            <Grid Width="{Binding ElementName=EUR3, Path=ActualWidth}"></Grid>
                                            <Grid Width="{Binding ElementName=NgoaiTe3, Path=ActualWidth}"></Grid>
                                            <Grid Width="{Binding ElementName=GoiThauChiPhiUSD, Path=ActualWidth}">
                                                <TextBlock FontWeight="Bold" Margin="0 8 0 0" TextAlignment="Right" Text="{Binding FGiaTriUSDChiPhi, StringFormat={}{0:N2}}" />
                                            </Grid>
                                            <Grid Width="{Binding ElementName=GoiThauChiPhiVND, Path=ActualWidth}">
                                                <TextBlock FontWeight="Bold" Margin="5 8 0 0" TextAlignment="Right" Text="{Binding FGiaTriVNDChiPhi, StringFormat={}{0:N0}}" />
                                            </Grid>
                                            <Grid Width="{Binding ElementName=GoiThauChiPhiEUR, Path=ActualWidth}">
                                                <TextBlock FontWeight="Bold" Margin="5 8 0 0" TextAlignment="Right" Text="{Binding FGiaTriEURChiPhi, StringFormat={}{0:N2}}" />
                                            </Grid>
                                            <Grid Width="{Binding ElementName=GoiThauChiPhiNgoaiTeKhac, Path=ActualWidth}">
                                                <TextBlock FontWeight="Bold" Margin="5 8 0 0" TextAlignment="Right" Text="{Binding FGiaTriNgoaiTeKhacChiPhi, StringFormat={}{0:N2}}" />
                                            </Grid>
                                        </StackPanel>
                                    </Border>
                                </DockPanel>
                            </StackPanel>
                        </StackPanel>
                    </StackPanel>
                </Grid>
            </ScrollViewer>
            <StackPanel Grid.Row="2">
                <Separator Background="{DynamicResource MaterialDesignDivider}"/>
                <StackPanel Orientation="Horizontal" Margin="0 10 0 0" HorizontalAlignment="Right">
                    <Button Visibility="{Binding IsViewOnly,Converter={StaticResource InvertBooleanToVisibilityConverter}}"
                        Margin="5 0 0 0"
                        Style="{StaticResource MaterialDesignRaisedButton}"
                        Command="{Binding SaveCommand}"
                        CommandParameter="{Binding EstimationDialog}">
                        <StackPanel Orientation="Horizontal">
                            <materialDesign:PackIcon Kind="ContentSave" />
                            <TextBlock Style="{StaticResource SearchBarBtnTextStyle}">Lưu dữ liệu</TextBlock>
                        </StackPanel>
                    </Button>
                    <Button
                        IsCancel="True"
                        Margin="5 0 0 0"
                        Style="{StaticResource MaterialDesignOutlinedButton}">
                        <StackPanel Orientation="Horizontal">
                            <materialDesign:PackIcon Kind="CloseOutline" />
                            <TextBlock Style="{StaticResource SearchBarBtnTextStyle}">Đóng</TextBlock>
                        </StackPanel>
                    </Button>
                </StackPanel>
            </StackPanel>
        </Grid>
    </materialDesign:DialogHost>
</Window>
