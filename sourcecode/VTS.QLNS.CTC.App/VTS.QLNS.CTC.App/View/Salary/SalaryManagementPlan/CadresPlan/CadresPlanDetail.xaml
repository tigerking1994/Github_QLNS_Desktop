<Window x:Class="VTS.QLNS.CTC.App.View.Salary.SalaryManagementPlan.CadresPlan.CadresPlanDetail"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:VTS.QLNS.CTC.App.View.Salary.SalaryManagementPlan.CadresPlan"
        mc:Ignorable="d"
        Title="Chi tiết cán bộ kế hoạch" Height="720" Width="1880"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        xmlns:wpf="clr-namespace:MaterialDesignThemes.Wpf;assembly=MaterialDesignThemes.Wpf"
        xmlns:system="clr-namespace:System;assembly=mscorlib"
        xmlns:converters="clr-namespace:VTS.QLNS.CTC.App.Converters"
        xmlns:helper="clr-namespace:VTS.QLNS.CTC.App.Helper"
        xmlns:extensions="clr-namespace:VTS.QLNS.CTC.App.Extensions"
        xmlns:component="clr-namespace:VTS.QLNS.CTC.App.Component"
        WindowState="Maximized"
        x:Name="DetailPlanWindow">
    <Window.InputBindings>
        <KeyBinding Key="F10" Command="{Binding SaveDataCommand}"/>
        <KeyBinding Key="F2" Command="{Binding SuaCommand}"/>
        <KeyBinding Gesture="Ctrl+F10" Command="{Binding SaveAndCloseCommand}" CommandParameter="{Binding ElementName=DetailWindow}"/>
        <KeyBinding Gesture="Alt+F10" Command="{Binding SaveAndCopyCommand}" />
    </Window.InputBindings>
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <StackPanel Orientation="Vertical" Grid.ColumnSpan="4">
            <DockPanel>
                <StackPanel DockPanel.Dock="Left" Orientation="Horizontal">
                    <materialDesign:PackIcon Kind="AccountDetails" Style="{StaticResource DialogScreenIconStyle}"/>
                    <StackPanel Orientation="Vertical">
                        <TextBlock Text="{Binding Title}" FontWeight="Bold"/>
                        <TextBlock Text="{Binding Description}"/>
                    </StackPanel>
                </StackPanel>
            </DockPanel>
            <Separator Background="{StaticResource MaterialDesignDivider}" Margin="0 5 0 0" />
        </StackPanel>

        <ScrollViewer
            Margin="0 5 0 0"
            Grid.Row="1" 
            Grid.ColumnSpan="4"
            HorizontalScrollBarVisibility="Auto">
            <StackPanel>
                <StackPanel Orientation="Horizontal">
                    <Button
                        Style="{StaticResource SearchBarBtnStyle}"
                        ToolTip="Refresh"
                        Command="{Binding RefreshCommand}">
                        <StackPanel Orientation="Horizontal">
                            <materialDesign:PackIcon Kind="Refresh" />
                            <TextBlock Style="{StaticResource SearchBarBtnTextStyle}" Text="(F5)" />
                        </StackPanel>
                    </Button>
                    <Separator 
                        Style="{StaticResource SearchBarHorizontalDividerStyle}" 
                        Visibility="{Binding EditVisibility}"/>
                    <Button
                        extensions:Permission.Identifier="SALARY_QUAN_LY_LUONG_KE_HOACH_DANH_SACH_DOI_TUONG_HUONG_LUONG_KE_HOACH_DETAIL_EDIT"
                        Style="{StaticResource SearchBarBtnStyle}"
                        Visibility="{Binding EditVisibility}"
                        Command="{Binding SuaCommand}"
                        IsEnabled="{Binding IsReadOnly}">
                        <StackPanel Orientation="Horizontal">
                            <materialDesign:PackIcon Kind="AccountEdit" />
                            <TextBlock 
                                Style="{StaticResource SearchBarBtnTextStyle}" 
                                Text="Sửa (F2)">
                            </TextBlock>
                        </StackPanel>
                    </Button>
                    <Separator Style="{StaticResource SearchBarHorizontalDividerStyle}" />
                    <Button 
                        extensions:Permission.Identifier="SALARY_QUAN_LY_LUONG_KE_HOACH_DANH_SACH_DOI_TUONG_HUONG_LUONG_KE_HOACH_DETAIL_SAVE"
                        Style="{StaticResource SearchBarBtnStyle}" 
                        IsEnabled="{Binding IsReadOnly, Converter={StaticResource InvertBooleanConverter}}" 
                        Command="{Binding SaveDataCommand}"
                        IsDefault="True"
                        Margin="5 0 0 0">
                        <StackPanel Orientation="Horizontal">
                            <materialDesign:PackIcon Kind="ContentSave" />
                            <TextBlock 
                                Style="{StaticResource SearchBarBtnTextStyle}" 
                                Text="Lưu dữ liệu (F10)">
                            </TextBlock>
                        </StackPanel>
                    </Button>
                    <Separator Style="{StaticResource SearchBarHorizontalDividerStyle}" />
                    <Button 
                        Visibility="{Binding SaveVisibility}"
                        Style="{StaticResource SearchBarBtnStyle}" 
                        IsEnabled="{Binding IsReadOnly, Converter={StaticResource InvertBooleanConverter}}" 
                        Command="{Binding SaveAndCloseCommand}"
                        CommandParameter="{Binding ElementName=DetailWindow}"
                        IsDefault="True"
                        Margin="5 0 0 0">
                        <StackPanel Orientation="Horizontal">
                            <materialDesign:PackIcon Kind="ContentSave" />
                            <TextBlock 
                                Style="{StaticResource SearchBarBtnTextStyle}" 
                                Text="Lưu và đóng (Ctrl+F10)">
                            </TextBlock>
                        </StackPanel>
                    </Button>
                    <Separator 
                        Style="{StaticResource SearchBarHorizontalDividerStyle}" 
                        Visibility="{Binding SaveVisibility}"/>
                    <Button 
                        Visibility="{Binding SaveVisibility}"
                        Style="{StaticResource SearchBarBtnStyle}" 
                        IsEnabled="{Binding IsReadOnly, Converter={StaticResource InvertBooleanConverter}}" 
                        Command="{Binding SaveAndCopyCommand}"
                        IsDefault="True"
                        Margin="5 0 0 0">
                        <StackPanel Orientation="Horizontal">
                            <materialDesign:PackIcon Kind="ContentSave" />
                            <TextBlock 
                                Style="{StaticResource SearchBarBtnTextStyle}" 
                                Text="Lưu và sao chép (Alt+F10)">
                            </TextBlock>
                        </StackPanel>
                    </Button>
                    <Separator 
                        Style="{StaticResource SearchBarHorizontalDividerStyle}" 
                        Visibility="{Binding SaveVisibility}"/>
                    <StackPanel
                        HorizontalAlignment="Right"
                        VerticalAlignment="Center"
                        Orientation="Horizontal"
                        Visibility="{Binding Visibility}">
                        <Button
                            Style="{StaticResource MaterialDesignOutlinedButton}"
                            IsEnabled="{Binding BackEnabled}"
                            Command="{Binding FirstCommand}">
                            <materialDesign:PackIcon Kind="SkipBackward"/>
                        </Button>
                        <Button
                            Margin="5 0 0 0"
                            Style="{StaticResource MaterialDesignOutlinedButton}"
                            IsEnabled="{Binding BackEnabled}"
                            Command="{Binding PreviousCommand}">
                            <materialDesign:PackIcon Kind="SkipPrevious"/>
                        </Button>
                        <Button
                            Margin="5 0 0 0"
                            Style="{StaticResource MaterialDesignOutlinedButton}"
                            IsEnabled="{Binding NextEnabled}"
                            Command="{Binding NextCommand}">
                            <materialDesign:PackIcon Kind="SkipNext"/>
                        </Button>
                        <Button
                            Margin="5 0 0 0"
                            Style="{StaticResource MaterialDesignOutlinedButton}"
                            IsEnabled="{Binding NextEnabled}"
                            Command="{Binding LastCommand}">
                            <materialDesign:PackIcon Kind="SkipForward"/>
                        </Button>
                        <Separator Style="{StaticResource SearchBarHorizontalDividerStyle}" />

                    </StackPanel>
                    <Button
                        Margin="5 0 0 0"
                        Style="{StaticResource SearchBarBtnStyle}"
                        Command="{Binding CloseCommand}"
                        CommandParameter="{Binding ElementName=DetailPlanWindow}">
                        <StackPanel Orientation="Horizontal">
                            <materialDesign:PackIcon Kind="CloseOutline" />
                            <TextBlock Style="{StaticResource SearchBarBtnTextStyle}">Đóng</TextBlock>
                        </StackPanel>
                    </Button>

                    <Grid Visibility="{Binding Visibility}" Margin="105 0 0 0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="465*"/>
                            <ColumnDefinition Width="67*"/>
                            <ColumnDefinition Width="64*"/>
                            <ColumnDefinition Width="334*"/>
                        </Grid.ColumnDefinitions>
                        <StackPanel 
                            x:Name="stSearch" 
                            Orientation="Horizontal"
                            Margin="10 0 0 5">
                            <TextBox 
                                TabIndex="0"
                                Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                                Width="150"
                                materialDesign:HintAssist.Hint="Mã hưởng lương, phụ cấp" 
                                Text="{Binding SearchSoSoLuong}">
                            </TextBox>
                            <TextBox 
                                TabIndex="1"
                                Margin="5 0 0 0"
                                Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                                Width="150"
                                materialDesign:HintAssist.Hint="Đối tượng hưởng lương, phụ cấp" 
                                Text="{Binding SearchDoiTuong}">
                            </TextBox>
                            <TextBox 
                                TabIndex="2"
                                Margin="5 0 0 0"
                                Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                                Width="150"
                                materialDesign:HintAssist.Hint="Mã cấp bậc" 
                                Text="{Binding SearchCapBac}">
                            </TextBox>
                            <Button 
                                Margin="5 5 0 0"
                                Style="{StaticResource SearchBarBtnStyle}" 
                                Command="{Binding SearchCanBoCommand}">
                                <StackPanel Orientation="Horizontal">
                                    <materialDesign:PackIcon Kind="Search" />
                                    <TextBlock Style="{StaticResource SearchBarBtnTextStyle}" Text="Tìm kiếm"/>
                                    <materialDesign:PopupBox
                                        PlacementMode="BottomAndAlignRightEdges"
                                        StaysOpen="True"
                                        IsPopupOpen="{Binding IsPopupOpen, Mode=TwoWay}">
                                        <materialDesign:PopupBox.ToggleContent>
                                            <materialDesign:PackIcon Kind="MenuDown"/>
                                        </materialDesign:PopupBox.ToggleContent>
                                        <StackPanel>
                                            <component:ExpandedDataGrid
                                                Width="{Binding ElementName=stSearch, Path=ActualWidth}"
                                                Margin="10"
                                                GridLinesVisibility="All"
                                                VerticalAlignment="Top" 
                                                AutoGenerateColumns="False" 
                                                CanUserResizeColumns="True"
                                                BorderThickness="1"
                                                HorizontalScrollBarVisibility="Auto"
                                                CanUserAddRows="False"
                                                ItemsSource="{Binding LstCanBo}"
                                                SelectedItem="{Binding SelectedCanBo}"
                                                IsReadOnly="True"
                                                RowStyle="{StaticResource DataGridRowDetail}"
                                                CellStyle="{StaticResource DataGridCellDetail}"
                                                Style="{StaticResource MaterialDesignDataGrid}">
                                                <DataGrid.Columns>
                                                    <DataGridTextColumn Header="Mã đối tượng" Binding="{Binding MaCanbo}"/>
                                                    <DataGridTextColumn Header="Tên cán bộ" Binding="{Binding TenCanBo}"/>
                                                    <DataGridTextColumn Header="Cấp bậc" Binding="{Binding CapBac}"/>
                                                    <DataGridTextColumn Header="Chức vụ" Binding="{Binding ChucVu}"/>
                                                    <DataGridTextColumn Header="Năm thâm niên" Binding="{Binding NamTn}"/>
                                                </DataGrid.Columns>
                                            </component:ExpandedDataGrid>
                                            <Separator Background="{StaticResource MaterialDesignDivider}"/>
                                            <StackPanel Orientation="Horizontal" Margin="0 5 0 0" HorizontalAlignment="Right">
                                                <Button
                                                    IsEnabled="{Binding ChooseEnabled}"
                                                    Margin="5 0 0 0"
                                                    Style="{StaticResource MaterialDesignRaisedButton}"
                                                    Command="{Binding ChooseCommand}">
                                                    <StackPanel Orientation="Horizontal">
                                                        <materialDesign:PackIcon Kind="ContentSave" />
                                                        <TextBlock Style="{StaticResource SearchBarBtnTextStyle}">Chọn đối tượng</TextBlock>
                                                    </StackPanel>
                                                </Button>
                                                <Button
                                                    Command="{Binding CloseDatagridCommand}"
                                                    Margin="5 0 5 0"
                                                    Style="{StaticResource MaterialDesignOutlinedButton}">
                                                    <StackPanel Orientation="Horizontal">
                                                        <materialDesign:PackIcon Kind="CloseOutline" />
                                                        <TextBlock Style="{StaticResource SearchBarBtnTextStyle}">Đóng</TextBlock>
                                                    </StackPanel>
                                                </Button>
                                            </StackPanel>
                                        </StackPanel>
                                    </materialDesign:PopupBox>
                                </StackPanel>
                            </Button>
                        </StackPanel>
                    </Grid>
                </StackPanel>
                <Separator 
                    DockPanel.Dock="Top"
                    Background="{StaticResource MaterialDesignDivider}" 
                    Margin="0 5 0 10" 
                    Grid.ColumnSpan="4"/>
            </StackPanel>
        </ScrollViewer>

        <Grid Grid.Row="3">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <TextBlock
                Margin="0 0 0 -10"
                Grid.Column="0"
                x:Name="ThongTinChung"
                FontWeight="SemiBold"
                Text="Thông tin chung"
                extensions:TextBlockTransform.CharacterCasing="Upper"/>

            <ScrollViewer 
                VerticalScrollBarVisibility="Visible"
                Grid.RowSpan="5"
                Grid.Row="3">
                <Grid
                    Margin="-10 0 0 0"
                    Grid.Column="0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" MinWidth="200"/>
                        <ColumnDefinition Width="*" MinWidth="200"/>
                        <ColumnDefinition Width="*" MinWidth="200"/>
                    </Grid.ColumnDefinitions>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <Grid.Resources>
                        <Style TargetType="TextBox" BasedOn="{StaticResource MaterialDesignTextBox}">
                            <Setter Property="materialDesign:HintAssist.IsFloating" Value="True" />
                            <Setter Property="Margin" Value="10 5 0 0" />
                            <Setter Property="HorizontalAlignment" Value="Stretch" />
                            <Setter Property="VerticalAlignment" Value="Center" />
                            <Setter Property="materialDesign:HintAssist.FloatingScale" Value="0.8"/>
                            <Setter Property="IsReadOnly" Value="{Binding IsReadOnly}"/>
                        </Style>

                        <Style TargetType="DatePicker" BasedOn="{StaticResource MaterialDesignFloatingHintDatePicker}">
                            <Setter Property="materialDesign:HintAssist.IsFloating" Value="True" />
                            <Setter Property="Margin" Value="10 5 0 0" />
                            <Setter Property="HorizontalAlignment" Value="Stretch" />
                            <Setter Property="VerticalAlignment" Value="Center" />
                            <Setter Property="materialDesign:HintAssist.FloatingScale" Value="0.8"/>
                            <Setter 
                                Property="IsEnabled" 
                                Value="{Binding IsReadOnly, Converter={StaticResource InvertBooleanConverter}}"/>
                        </Style>

                        <Style TargetType="ComboBox" BasedOn="{StaticResource MaterialDesignFloatingHintComboBox}">
                            <Setter Property="materialDesign:HintAssist.IsFloating" Value="True" />
                            <Setter Property="Margin" Value="10 5 0 0" />
                            <Setter Property="HorizontalAlignment" Value="Stretch"/>
                            <Setter Property="VerticalAlignment" Value="Center" />
                            <Setter Property="materialDesign:HintAssist.FloatingScale" Value="0.8"/>
                            <Setter Property="IsEditable" Value="True"/>
                            <Setter 
                                Property="IsEnabled" 
                                Value="{Binding IsReadOnly, Converter={StaticResource InvertBooleanConverter}}"/>
                        </Style>
                    </Grid.Resources>

                    <StackPanel 
                        Grid.Row="1"
                        Margin="0 5 0 0"
                        Orientation="Vertical">
                        <ComboBox 
                            VirtualizingStackPanel.IsVirtualizing="True"
                            TabIndex="3"
                            materialDesign:HintAssist.Hint="Chọn đơn vị" 
                            ItemsSource="{Binding DonViItems}"
                            SelectedItem="{Binding SelectedDonVi}"
                            DisplayMemberPath="TenDonVi">
                            <ComboBox.ItemsPanel>
                                <ItemsPanelTemplate >
                                    <VirtualizingStackPanel/>
                                </ItemsPanelTemplate>
                            </ComboBox.ItemsPanel>
                        </ComboBox>
                            <TextBox
                            TabIndex="6"
                            materialDesign:HintAssist.Hint="Tên đối tượng hưởng lương, phụ cấp" 
                            Text="{Binding Model.TenCanBo}" />
                        <ComboBox
                            TabIndex="9"
                            materialDesign:HintAssist.Hint="Hệ số chức vụ"
                            ItemsSource="{Binding ItemsChucVu}"
                            SelectedItem="{Binding SelectedChucVu}"
                            DisplayMemberPath="ChucVuDisplay"/>
                        <DatePicker 
                            Language="vi-VN"
                            TabIndex="12"
                            materialDesign:HintAssist.Hint="Ngày nhập ngũ"  
                            SelectedDate="{Binding NgayNhapNgu}" />
                        <TextBox 
                            TabIndex="15"
                            materialDesign:HintAssist.Hint="Năm thâm niên" 
                            Text="{Binding NamThamNien, StringFormat=N0}"
                            IsReadOnly="True"/>
                        <CheckBox
                            TabIndex="18"
                            IsEnabled="{Binding IsReadOnly, Converter={StaticResource InvertBooleanConverter}}"
                            materialDesign:HintAssist.Hint="Nhận lương qua tài khoản"
                            Content="Nhận lương qua tài khoản"
                            VerticalAlignment="Center"
                            IsChecked="{Binding Model.Tm}"
                            Margin="9 28 0 0">
                        </CheckBox>
                        <CheckBox
                            TabIndex="20"
                            IsEnabled="{Binding IsReadOnly, Converter={StaticResource InvertBooleanConverter}}"
                            materialDesign:HintAssist.Hint="Hưởng PC công vụ"
                            Content="Hưởng PC công vụ"
                            VerticalAlignment="Center"
                            IsChecked="{Binding Model.PCCV}"
                            Margin="9 15 0 0">
                        </CheckBox>

                    </StackPanel>
                    <StackPanel 
                        Grid.Row="1"
                        Grid.Column="1" 
                        Margin="0 5 0 0"
                        Orientation="Vertical">
                        <TextBox 
                            TabIndex="4"
                            IsReadOnly="True"
                            materialDesign:HintAssist.Hint="Mã hưởng lương, phụ cấp" 
                            Text="{Binding Model.MaCanBo}" />
                        <ComboBox 
                            TabIndex="7"
                            materialDesign:HintAssist.Hint="Cấp bậc"
                            ItemsSource="{Binding ItemsCapBac}"
                            SelectedItem="{Binding SelectedCapBac}"
                            DisplayMemberPath="CapBacDisplay"/>
                        <TextBox 
                            TabIndex="10"
                            materialDesign:HintAssist.Hint="Số người phụ thuộc" 
                            Text="{Binding SoNguoiPhuThuoc, StringFormat=N0}" />
                        <DatePicker 
                            Language="vi-VN"
                            TabIndex="13"
                            materialDesign:HintAssist.Hint="Ngày xuất ngũ" 
                            SelectedDate="{Binding NgayXuatNgu}" />
                        <TextBox 
                            TabIndex="16"
                            materialDesign:HintAssist.Hint="Tên ngân hàng" 
                            Text="{Binding Model.TenKhoBac}" />
                        <CheckBox
                            TabIndex="19"
                            IsEnabled="{Binding IsReadOnly, Converter={StaticResource InvertBooleanConverter}}"
                            materialDesign:HintAssist.Hint="Không tính lương"
                            Content="Không tính lương"
                            VerticalAlignment="Center"
                            IsChecked="{Binding Model.KhongLuong}"
                            Margin="9 28 0 0">
                        </CheckBox>
                        <CheckBox
                            TabIndex="21"
                            IsEnabled="{Binding IsReadOnly, Converter={StaticResource InvertBooleanConverter}}"
                            materialDesign:HintAssist.Hint="Nộp BHTN"
                            Content="Nộp BHTN"
                            VerticalAlignment="Center"
                            IsChecked="{Binding Model.BHTN}"
                            Margin="9 15 0 0">
                        </CheckBox>
                    </StackPanel>
                    <StackPanel 
                        Grid.Row="1"
                        Margin="0 5 0 0"
                        Grid.Column="2">
                        <ComboBox 
                            TabIndex="5"
                            materialDesign:HintAssist.Hint="Mã tăng giảm" 
                            ItemsSource="{Binding TangGiamItems}"
                            SelectedItem="{Binding SelectedTangGiamItems}"           
                            DisplayMemberPath="TangGiam"/>
                        <TextBox 
                            TabIndex="8"
                            materialDesign:HintAssist.Hint="Hệ số lương" 
                            Text="{Binding HeSoLuong, StringFormat=N2}" />
                        <TextBox 
                            TabIndex="11"
                            materialDesign:HintAssist.Hint="Tháng thâm niên nghề" 
                            Text="{Binding ThangThamNienNghe}" />
                        <DatePicker 
                            Language="vi-VN"
                            TabIndex="14"
                            materialDesign:HintAssist.Hint="Ngày tái ngũ"  
                            SelectedDate="{Binding NgayTaiNgu}" />
                        <TextBox
                            TabIndex="17"
                            materialDesign:HintAssist.Hint="Số tài khoản" 
                            Text="{Binding Model.SoTaiKhoan}" />

                        <CheckBox
                            TabIndex="23"
                            IsEnabled="{Binding IsReadOnly, Converter={StaticResource InvertBooleanConverter}}"
                            materialDesign:HintAssist.Hint="Chỉ tính Tháng thâm niên nghề"
                            Content="Chỉ tính Tháng thâm niên nghề"
                            IsChecked="{Binding Model.BKhongTinhNTN}"
                            Margin="9 28 0 0">
                        </CheckBox>
                        <CheckBox
                            TabIndex="23"
                            IsEnabled="{Binding IsReadOnly, Converter={StaticResource InvertBooleanConverter}}"
                            materialDesign:HintAssist.Hint="Ở nước ngoài"
                            Content="Ở nước ngoài"
                            IsChecked="{Binding Model.BNuocNgoai}"
                            Margin="9 15 0 0">
                        </CheckBox>
                    </StackPanel>

                    <TextBlock
                        Margin="10 20 0 -10"
                        Grid.Column="0"
                        Grid.Row="2"
                        FontWeight="SemiBold"
                        Text="Thông tin kế hoạch"
                        extensions:TextBlockTransform.CharacterCasing="Upper"/>
                    <StackPanel 
                        Margin="0 5 0 0"
                        Grid.Column="0"
                        Grid.Row="3">
                        <DatePicker 
                            Language="vi-VN"
                            TabIndex="25"
                            materialDesign:HintAssist.Hint="Ngày nhận quân hàm/hệ số lương" 
                            SelectedDate="{Binding Model.NgayNhanCb}" />
                        <ComboBox
                            TabIndex="28"
                            x:Name="cbHslKh"
                            materialDesign:HintAssist.Hint="Hệ số lương kế hoạch"
                            ItemsSource="{Binding ItemsHslKeHoach}"
                            SelectedItem="{Binding SelectedHslKeHoach}"
                            TextSearch.TextPath="Display"
                            DisplayMemberPath="Display"/>
                        <ComboBox
                            TabIndex="31"
                            materialDesign:HintAssist.Hint="Giới tính"
                            DisplayMemberPath="DisplayItem"
                            SelectedValuePath="ValueItem"
                            TextSearch.TextPath="DisplayItem"
                            ItemsSource="{Binding GenderData, Mode=TwoWay}"
                            SelectedItem="{Binding SelectedGender}"/>
                    </StackPanel>
                    <StackPanel 
                        Margin="0 5 0 0"
                        Grid.Column="1"
                        Grid.Row="3">
                        <TextBox
                            TabIndex="26"
                            IsReadOnly="True"
                            materialDesign:HintAssist.Hint="Thời hạn tăng quân hàm/hệ số lương" 
                            Text="{Binding Model.ThoiHanTangCb}" />
                        <ComboBox 
                            TabIndex="29"
                            x:Name="cbHslTran"
                            materialDesign:HintAssist.Hint="Hệ số lương trần"
                            ItemsSource="{Binding ItemsHslKeHoach}"
                            SelectedItem="{Binding SelectedHslKeHoachTran}"
                            TextSearch.TextPath="Display"
                            DisplayMemberPath="Display"/>
                    </StackPanel>
                    <StackPanel 
                        Margin="0 5 0 0"
                        Grid.Column="2"
                        Grid.Row="3">
                        <ComboBox
                            TabIndex="27"
                            materialDesign:HintAssist.Hint="Nhóm"
                            ItemsSource="{Binding ItemsNhom, Mode=TwoWay}"
                            SelectedItem="{Binding SelectedNhom}"
                            TextSearch.TextPath="DisplayItem"
                            DisplayMemberPath="DisplayItem"/>
                        <DatePicker
                            Language="vi-VN"
                            TabIndex="30"
                            materialDesign:HintAssist.Hint="Ngày sinh" 
                            SelectedDate="{Binding Model.NgaySinh}"/>
                    </StackPanel>

                    <TextBlock
                        Margin="10 15 0 -10"
                        Grid.Column="0"
                        Grid.Row="4"
                        FontWeight="SemiBold"
                        Text="Thông tin bổ sung"
                        extensions:TextBlockTransform.CharacterCasing="Upper"/>
                    <StackPanel 
                        Margin="0 25 0 0"
                        Grid.Column="0"
                        Grid.Row="5">
                        <TextBox
                            TabIndex="32"
                            materialDesign:HintAssist.Hint="Căn cước công dân" 
                            Text="{Binding Model.Cccd}" />
                        <TextBox 
                            TabIndex="35"
                            materialDesign:HintAssist.Hint="Địa chỉ" 
                            Text="{Binding Model.DiaChi}" />
                    </StackPanel>
                    <StackPanel 
                        Margin="0 25 0 0"
                        Grid.Column="1"
                        Grid.Row="5">
                        <TextBox 
                            TabIndex="33"
                            materialDesign:HintAssist.Hint="Số điện thoại" 
                            Text="{Binding Model.DienThoai}" />
                        <TextBox
                            TabIndex="36"
                            materialDesign:HintAssist.Hint="Mã số thuế TNCN" 
                            Text="{Binding Model.MaSoVat}" />
                    </StackPanel>
                    <StackPanel 
                        Margin="0 25 0 0"
                        Grid.Column="2"
                        Grid.Row="5">
                        <TextBox
                            TabIndex="34"
                            materialDesign:HintAssist.Hint="Nơi công tác" 
                            Text="{Binding Model.NoiCongTac}" />
                    </StackPanel>
                </Grid>
            </ScrollViewer>

            <TextBlock
                Margin="10 0 0 -10"
                Grid.Column="4"
                FontWeight="SemiBold"
                Text="Thông tin thay đổi"
                extensions:TextBlockTransform.CharacterCasing="Upper"/>

            <Grid
                Grid.Row="0" 
                Grid.RowSpan="5"
                Grid.Column="4"
                Margin="10 0 0 5"
                x:Name="column4">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <StackPanel
                    DockPanel.Dock="Top"
                    Orientation="Horizontal"
                    Margin="0"
                    VerticalAlignment="Center">
                    <Grid Width="{Binding ElementName=MaPhuCap, Path=ActualWidth}">
                        <TextBox
                            x:Name="tbxSearchPhuCap"
                            Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                            materialDesign:HintAssist.Hint="Mã phụ cấp"
                            Text="{Binding SearchMaPhuCap, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                            VerticalAlignment="Center">
                            <TextBox.InputBindings>
                                <KeyBinding Command="{Binding SearchCommand}" Key="Return" />
                            </TextBox.InputBindings>
                        </TextBox>
                    </Grid>
                    <Grid 
                        Width="{Binding ElementName=TenPhuCap, Path=ActualWidth}"
                        Margin="5 0 0 0">
                        <TextBox
                            x:Name="SearchTenPhuCap"
                            Style="{StaticResource MaterialDesignFloatingHintTextBox}"
                            materialDesign:HintAssist.Hint="Tên phụ cấp"
                            Text="{Binding SearchTenPhuCap, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                            VerticalAlignment="Center">
                            <TextBox.InputBindings>
                                <KeyBinding Command="{Binding SearchCommand}" Key="Return" />
                            </TextBox.InputBindings>
                        </TextBox>
                    </Grid>
                    <Separator Style="{StaticResource SearchBarHorizontalDividerStyle}"/>
                    <Button 
                        Style="{StaticResource SearchBarBtnStyle}" 
                        Command="{Binding SearchCommand}"
                        IsDefault="{Binding ElementName=SearchTenPhuCap, Path=IsKeyboardFocused}">
                        <StackPanel Orientation="Horizontal">
                            <materialDesign:PackIcon Kind="Search" />
                            <TextBlock Style="{StaticResource SearchBarBtnTextStyle}" Text="Tìm kiếm"/>
                        </StackPanel>
                    </Button>
                    <Button 
                        Style="{StaticResource SearchBarBtnStyle}"
                        ToolTip="Filter"
                        Command="{Binding ResetFilterCommand}">
                        <StackPanel Orientation="Horizontal">
                            <materialDesign:PackIcon Kind="FilterRemoveOutline" />
                        </StackPanel>
                    </Button>
                    <Separator Style="{StaticResource SearchBarHorizontalDividerStyle}"/>
                    <Button x:Name="btnShowColSelfPay" Style="{StaticResource SearchBarBtnStyle}">
                        <StackPanel Orientation="Horizontal">
                            <materialDesign:PackIcon Kind="PlusMinusVariant" />
                            <TextBlock Style="{StaticResource SearchBarBtnTextStyle}" Text="Ẩn/hiện cột" />
                            <materialDesign:PopupBox
                                Name="pbDynamicColumn"
                                Margin="-10 0 0 0"
                                HorizontalAlignment="Right"
                                StaysOpen="True">
                                <materialDesign:PopupBox.Resources>
                                    <Style TargetType="ScrollViewer">
                                        <Setter Property="Height" Value="400" />
                                    </Style>
                                </materialDesign:PopupBox.Resources>
                                <materialDesign:PopupBox.ToggleContent>
                                    <materialDesign:PackIcon Kind="MenuDown"/>
                                </materialDesign:PopupBox.ToggleContent>
                                <ScrollViewer></ScrollViewer>
                            </materialDesign:PopupBox>
                        </StackPanel>
                    </Button>
                </StackPanel>

                <component:ExpandedDataGrid
                    Grid.Row="1"
                    x:Name="dgAllowanceDetail"
                    Margin="0 5 0 0"
                    FrozenColumnCount="2"
                    BorderThickness="1"
                    CanUserAddRows="False"
                    CanUserResizeColumns="False"
                    GridLinesVisibility="All"
                    VerticalScrollBarVisibility="Auto"
                    HorizontalScrollBarVisibility="Auto"
                    RowStyle="{StaticResource DataGridRowDetail}"
                    CellStyle="{StaticResource DataGridCellDetail}"
                    Style="{StaticResource MaterialDesignDataGrid}"
                    ScrollViewer.VerticalScrollBarVisibility="Visible"
                    ScrollViewer.HorizontalScrollBarVisibility="Visible"
                    AutoGenerateColumns="False"
                    ItemsSource="{Binding ItemsAllowence}"
                    SelectedItem="{Binding SelectedAllowence, Mode=TwoWay}"
                    IsReadOnly="{Binding IsReadOnly}"
                    ElementDynamicColumn="{Binding ElementName=pbDynamicColumn, Path=., Mode=TwoWay}">
                    <DataGrid.GroupStyle>
                        <GroupStyle>
                            <GroupStyle.ContainerStyle>
                                <Style TargetType="{x:Type GroupItem}">
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="{x:Type GroupItem}">
                                                <Expander
                                                    Style="{StaticResource DataGridExpander}"
                                                    IsExpanded="True" 
                                                    HorizontalAlignment="Stretch"
                                                    MinWidth="200"
                                                    wpf:ExpanderAssist.HorizontalHeaderPadding="5">
                                                    <Expander.Header>
                                                        <StackPanel>
                                                            <TextBlock 
                                                                FontWeight="SemiBold" 
                                                                Text="{Binding Path=Name}"
                                                                Margin="5 0 0 0"
                                                                MinWidth="100"
                                                                HorizontalAlignment="Left"/>
                                                        </StackPanel>
                                                    </Expander.Header>
                                                    <Expander.Content>
                                                        <ItemsPresenter/>
                                                    </Expander.Content>
                                                </Expander>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                </Style>
                            </GroupStyle.ContainerStyle>
                        </GroupStyle>
                        <GroupStyle>
                            <GroupStyle.HeaderTemplate>
                                <DataTemplate>
                                    <DockPanel>
                                        <TextBlock Text="{Binding Path=Name}"/>
                                    </DockPanel>
                                </DataTemplate>
                            </GroupStyle.HeaderTemplate>
                        </GroupStyle>
                    </DataGrid.GroupStyle>
                    <DataGrid.Columns>
                        <DataGridTextColumn 
                            x:Name="MaPhuCap"
                            IsReadOnly="True" 
                            Header="Mã Phụ Cấp" 
                            ElementStyle="{StaticResource DataGridTextColumnStyle}" 
                            Binding="{Binding MaPhuCap}"/>
                        <DataGridTextColumn 
                            x:Name="TenPhuCap"
                            IsReadOnly="True" 
                            Header="Tên Phụ Cấp" 
                            ElementStyle="{StaticResource DataGridTextColumnStyle}" 
                            Binding="{Binding TenPhuCap}"/>
                        <DataGridTextColumn 
                            Header="Giá trị"
                            x:Name="GiaTri"
                            Width="120"
                            ElementStyle="{StaticResource DataGridTextColumnStyle}" 
                            EditingElementStyle="{StaticResource MaterialDesignDataGridTextColumnEditingStyle}" 
                            Binding="{Binding GiaTri, StringFormat=N2, UpdateSourceTrigger=LostFocus}"/>
                        <DataGridTextColumn
                            Header="Số ngày hưởng"
                            x:Name="SoNgayHuong"
                            ElementStyle="{StaticResource DataGridTextColumnStyle}"
                            EditingElementStyle="{StaticResource MaterialDesignDataGridTextColumnEditingStyle}"
                            Binding="{Binding HuongPCSN}"/>
                    </DataGrid.Columns>
                </component:ExpandedDataGrid>

                <Grid 
                    Grid.Row="2">
                    <Grid.Resources>
                        <Style TargetType="TextBox" BasedOn="{StaticResource MaterialDesignTextBox}">
                            <Setter Property="materialDesign:HintAssist.IsFloating" Value="True" />
                            <Setter Property="HorizontalAlignment" Value="Stretch" />
                            <Setter Property="VerticalAlignment" Value="Center" />
                            <Setter Property="materialDesign:HintAssist.FloatingScale" Value="0.8"/>
                            <Setter Property="IsReadOnly" Value="{Binding IsReadOnly}"/>
                        </Style>
                        <Style TargetType="DatePicker" BasedOn="{StaticResource MaterialDesignFloatingHintDatePicker}">
                            <Setter Property="materialDesign:HintAssist.IsFloating" Value="True" />
                            <Setter Property="HorizontalAlignment" Value="Stretch" />
                            <Setter Property="VerticalAlignment" Value="Center" />
                            <Setter Property="materialDesign:HintAssist.FloatingScale" Value="0.8"/>
                            <Setter 
                                Property="IsEnabled" 
                                Value="{Binding IsReadOnly, Converter={StaticResource InvertBooleanConverter}}"/>
                        </Style>
                        <Style TargetType="ComboBox" BasedOn="{StaticResource MaterialDesignFloatingHintComboBox}">
                            <Setter Property="materialDesign:HintAssist.IsFloating" Value="True" />
                            <Setter Property="HorizontalAlignment" Value="Stretch"/>
                            <Setter Property="VerticalAlignment" Value="Center" />
                            <Setter Property="materialDesign:HintAssist.FloatingScale" Value="0.8"/>
                            <Setter Property="IsEditable" Value="True"/>
                            <Setter 
                                Property="IsEnabled" 
                                Value="{Binding IsReadOnly, Converter={StaticResource InvertBooleanConverter}}"/>
                        </Style>
                    </Grid.Resources>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    <ComboBox
                        Grid.Column="0"
                        materialDesign:HintAssist.Hint="Phụ cấp thời hạn"
                        IsEnabled="False"
                        ItemsSource="{Binding ItemsAllowenceHuong, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                        SelectedItem="{Binding SelectedAllowenceHuong, Mode=TwoWay}"
                        DisplayMemberPath="MaPhuCap"/>
                    <DatePicker
                        Margin="10 0 0 0"
                        Grid.Column="1"
                        Language="vi-VN"
                        materialDesign:HintAssist.Hint="Ngày bắt đầu hưởng" 
                        SelectedDate="{Binding SelectedAllowenceHuong.DateStart, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                    <TextBox
                        Margin="10 0 0 0"
                        Grid.Column="2"
                        materialDesign:HintAssist.Hint="Số tháng đã hưởng" 
                        Text="{Binding SelectedAllowenceHuong.ISoThangHuong, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />
                </Grid>
            </Grid>
        </Grid>
    </Grid>
</Window>
