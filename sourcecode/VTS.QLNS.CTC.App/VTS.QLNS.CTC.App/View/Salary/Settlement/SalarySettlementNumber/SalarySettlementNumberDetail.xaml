<Window x:Class="VTS.QLNS.CTC.App.View.Salary.Settlement.SalarySettlementNumber.SalarySettlementNumberDetail"
         x:Name="ArmyDetailWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:system="clr-namespace:System;assembly=mscorlib"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:wpf="clr-namespace:MaterialDesignThemes.Wpf;assembly=MaterialDesignThemes.Wpf"
        xmlns:localEnum="clr-namespace:VTS.QLNS.CTC.Utility.Enum;assembly=VTS.QLNS.CTC.Utility"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        xmlns:component="clr-namespace:VTS.QLNS.CTC.App.Component"
        xmlns:ext="clr-namespace:VTS.QLNS.CTC.App.Extensions"
        xmlns:local="clr-namespace:VTS.QLNS.CTC.App.View.Salary.Settlement.SalarySettlementNumber"
        mc:Ignorable="d"
        Style="{StaticResource MaterialDesignWindow}" 
        Title="{Binding Title}" 
        Height="800"
        Width="1600"
        WindowStartupLocation="CenterScreen"
        WindowState="Maximized"
        Icon="/favicon.ico">
    <Window.InputBindings>
        <KeyBinding Key="F4" Command="{Binding DeleteCommand}" CommandParameter="{Binding ElementName=DgArmyDetail, Path=.}"/>
        <KeyBinding Key="F10" Command="{Binding SaveCommand}" />
        <KeyBinding Key="F5" Command="{Binding ReloadDataCommand}" />
    </Window.InputBindings>
    <materialDesign:DialogHost
        Identifier="ArmyDetailDialog"
        DialogTheme="Inherit">
        <Grid Margin="16">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*" />
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            <StackPanel 
                Grid.Row="0"
                Orientation="Vertical">
                <DockPanel>
                    <materialDesign:PackIcon Kind="Dollar" Style="{StaticResource DialogScreenIconStyle}"/>
                    <StackPanel Orientation="Vertical" VerticalAlignment="Center">
                        <TextBlock Text="CHỨNG TỪ CHI TIẾT" FontWeight="Bold"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Orientation="Horizontal" Grid.Column="0">
                                <TextBlock Text="{Binding Description}">
                                </TextBlock>
                            </StackPanel>
                        </Grid>
                    </StackPanel>
                </DockPanel>
                <Separator Background="{DynamicResource MaterialDesignDivider}"/>
            </StackPanel>
            <StackPanel
                Grid.Row="1"
                Orientation="Horizontal">
                <Button
                    ext:Permission.Identifier="SALARY_SETTLEMENT_SETTLEMENT_NUMBER_DETAIL_UPDATE"
                    Style="{DynamicResource SearchBarBtnStyle}"
                    Visibility="{Binding IsShowCapNhat, Converter={StaticResource BooleanToVisibilityConverter}}"
                    Command="{Binding OnCapNhapchungTuCommand}">
                    <StackPanel Orientation="Horizontal">
                        <materialDesign:PackIcon Kind="AccountEdit" />
                        <TextBlock Style="{StaticResource SearchBarBtnTextStyle}" Text="Cập nhập lại dữ liệu"/>
                    </StackPanel>
                </Button>
                <Separator Style="{StaticResource SearchBarHorizontalDividerStyle}" 
                    Visibility="{Binding IsShowCapNhat, Converter={StaticResource BooleanToVisibilityConverter}}"/>
                <Button
                    Style="{DynamicResource SearchBarBtnStyle}"
                    Command="{Binding SaveCommand}">
                    <StackPanel Orientation="Horizontal">
                        <materialDesign:PackIcon Kind="ContentSave"/>
                        <TextBlock Style="{StaticResource SearchBarBtnTextStyle}" Text="Lưu dữ liệu (F10)"/>
                    </StackPanel>
                </Button>
                <Separator Style="{StaticResource SearchBarHorizontalDividerStyle}"/>
                <Button 
                    Style="{StaticResource SearchBarBtnStyle}"
                    ToolTip="Refresh"
                    Command="{Binding RefreshCommand}">
                    <StackPanel Orientation="Horizontal">
                        <materialDesign:PackIcon Kind="Refresh" />
                        <TextBlock Style="{StaticResource SearchBarBtnTextStyle}" Text="(F5)"/>
                    </StackPanel>
                </Button>
                <!--<Separator Style="{StaticResource SearchBarHorizontalDividerStyle}" />
                <Button 
                    ext:Permission.Identifier="SALARY_SETTLEMENT_SETTLEMENT_NUMBER_DETAIL_LOCK"
                    Style="{StaticResource SearchBarBtnStyle}"
                    Command="">
                    <StackPanel Orientation="Horizontal">
                        <materialDesign:PackIcon Kind="{Binding IsLock, Converter={StaticResource InvertBooleanToLockIconConverter}}" />
                        <TextBlock
                            Style="{StaticResource SearchBarBtnTextStyle}" 
                            x:Name="TblLock"/>
                    </StackPanel>
                </Button>-->
                <StackPanel Orientation="Horizontal">
                    <TextBlock x:Name="TblIsEdit"  Visibility="Collapsed"/>
                </StackPanel>
                <Separator Style="{StaticResource SearchBarHorizontalDividerStyle}" />
                <Button x:Name="btnShowColSelfPay" Style="{StaticResource SearchBarBtnStyle}">
                    <StackPanel Orientation="Horizontal">
                        <materialDesign:PackIcon Kind="PlusMinusVariant" />
                        <TextBlock Style="{StaticResource SearchBarBtnTextStyle}"  Text="Ẩn/hiện cột" />
                        <materialDesign:PopupBox
                            Name="pbDynamicColumn"
                            Margin="-10 0 0 0"
                            HorizontalAlignment="Right"
                            StaysOpen="True">
                            <materialDesign:PopupBox.Resources>
                                <Style TargetType="ScrollViewer">
                                    <Setter Property="Height" Value="400" />
                                </Style>
                            </materialDesign:PopupBox.Resources>
                            <materialDesign:PopupBox.ToggleContent>
                                <materialDesign:PackIcon Kind="MenuDown"/>
                            </materialDesign:PopupBox.ToggleContent>
                            <ScrollViewer></ScrollViewer>
                        </materialDesign:PopupBox>
                    </StackPanel>
                </Button>
                <Separator Style="{StaticResource SearchBarHorizontalDividerStyle}" />
                <!--<Button 
                    ext:Permission.Identifier="SALARY_SETTLEMENT_SETTLEMENT_NUMBER_DETAIL_EXPORT"
                    Style="{StaticResource SearchBarBtnStyle}">
                    <StackPanel Orientation="Horizontal">
                        <materialDesign:PackIcon Kind="FileExcel"/>
                        <TextBlock Style="{StaticResource SearchBarBtnTextStyle}" Text="Xuất dữ liệu"/>
                        <materialDesign:PopupBox
                                Margin="-10 0 0 0"
                                Grid.Column="1"
                                HorizontalAlignment="Right">
                            <materialDesign:PopupBox.ToggleContent>
                                <materialDesign:PackIcon Kind="MenuDown"/>
                            </materialDesign:PopupBox.ToggleContent>
                            <StackPanel>
                                <Button x:Name="btnCopyCarder" Command="{Binding OnPrintExcelCommand}">
                                    <StackPanel Orientation="Horizontal">
                                        <materialDesign:PackIcon Kind="FileExportOutline"/>
                                        <TextBlock Margin="10 0 0 0" Style="{StaticResource SearchBarBtnTextStyle}" Text="Excel"/>
                                    </StackPanel>
                                </Button>
                                <Button x:Name="btnTienIch" Command="{Binding OnPrintPDFCommand}">
                                    <StackPanel Orientation="Horizontal">
                                        <materialDesign:PackIcon Kind="FileExportOutline"/>
                                        <TextBlock Margin="10 0 0 0" Style="{StaticResource SearchBarBtnTextStyle}" Text="Pdf"/>
                                    </StackPanel>
                                </Button>
                                -->
                <!--<Button
                                        Command="{Binding PrintCommand}"
                                        CommandParameter="{x:Static utility:SalaryPrintType.BC_CHI_TIET_QUYET_TOAN_TX_THEO_COT}"
                                        Content="Chi tiết quyết toán thường xuyên theo cột" />-->
                <!--
                            </StackPanel>
                        </materialDesign:PopupBox>
                    </StackPanel>
                </Button>-->
                <Button
                    Command="{Binding PrintCommand}"
                    Style="{StaticResource SearchBarBtnStyle}">
                    <StackPanel Orientation="Horizontal">
                        <materialDesign:PackIcon Kind="Printer"/>
                        <TextBlock Style="{StaticResource SearchBarBtnTextStyle}" Text="In báo cáo"/>
                        <materialDesign:PopupBox
                            Margin="-10 0 0 0"
                            Grid.Column="1"
                            HorizontalAlignment="Right">
                            <materialDesign:PopupBox.ToggleContent>
                                <materialDesign:PackIcon Kind="MenuDown"/>
                            </materialDesign:PopupBox.ToggleContent>
                            <StackPanel>
                                <Button x:Name="btnCopyCarder" Command="{Binding ExportQsThangCommand}">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock 
                                            Margin="10 0 0 0" 
                                            Style="{StaticResource SearchBarBtnTextStyle}" 
                                            Text="Tổng hợp quân số tháng (Mẫu 01/QS)"/>
                                    </StackPanel>
                                </Button>

                                <Button Command="{Binding ExportQsQtCommand}">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock 
                                            Margin="10 0 0 0" 
                                            Style="{StaticResource SearchBarBtnTextStyle}" 
                                            Text="Tổng hợp quân số quyết toán (Mẫu 02/QS)"/>
                                    </StackPanel>
                                </Button>

                                <Button Command="{Binding ExportChiTietQsCommand}">
                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock 
                                            Margin="10 0 0 0" 
                                            Style="{StaticResource SearchBarBtnTextStyle}" 
                                            Text="Chi tiết quân số quyết toán theo MLQS"/>
                                    </StackPanel>
                                </Button>
                            </StackPanel>
                        </materialDesign:PopupBox>
                    </StackPanel>
                </Button>
                <Separator Style="{StaticResource SearchBarHorizontalDividerStyle}" />
                <ComboBox
                    Name="cbFrozenColumn"
                    materialDesign:HintAssist.Hint="Cố định cột"
                    DisplayMemberPath="DisplayItem"
                    SelectedValuePath="ValueItem"
                    Style="{StaticResource MaterialDesignFloatingHintComboBox}" />
                <Separator Style="{StaticResource SearchBarHorizontalDividerStyle}" />
                <Button
                     IsCancel="True"
                     Margin="5 0 0 0"
                     Style="{StaticResource SearchBarBtnStyle}">
                    <StackPanel Orientation="Horizontal">
                        <materialDesign:PackIcon Kind="CloseOutline" />
                        <TextBlock Style="{StaticResource SearchBarBtnTextStyle}">Đóng</TextBlock>
                    </StackPanel>
                    <Button.CommandParameter>
                        <system:Boolean>False</system:Boolean>
                    </Button.CommandParameter>
                </Button>
            </StackPanel>
            <component:ExpandedDataGrid
                x:Name="DgArmyDetail"
                Grid.Row="3"
                Margin="0 5 0 0"
                VerticalAlignment="Top"
                BorderThickness="1"
                AutoGenerateColumns="False"
                CanUserResizeColumns="True"
                CanUserReorderColumns="False"
                HorizontalScrollBarVisibility="Auto"
                FrozenColumnCount="2"
                CanUserAddRows="False"
                CanUserSortColumns="False"
                GridLinesVisibility="All"
                IsReadOnly="{Binding Model.IsLock}"
                ColumnInfo="{Binding Columns}"
                ElementFrozenColumn="{Binding ElementName=cbFrozenColumn, Path=., Mode=TwoWay}"
                ElementDynamicColumn="{Binding ElementName=pbDynamicColumn, Path=., Mode=TwoWay}"
                Style="{StaticResource MaterialDesignDataGrid}"
                ItemsSource="{Binding Items}"
                RowStyle="{StaticResource DataGridRowDetail}"
                CellStyle="{StaticResource DataGridCellDetail}"     
                BeginningEdit="dgdDataSettlementNumberDetail_BeginningEdit"
                wpf:DataGridAssist.CornerRadius="0 0 4 4" >
                <DataGrid.Columns>
                    <component:DataGridTextColumn 
                        x:Name="XauNoiMa"
                        Binding="{Binding XauNoiMa}" 
                        Header="#" 
                        IsReadOnly="True"
                        ElementStyle="{StaticResource DataGridTextColumnDetailStyle}"
                        HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}">
                        <DataGridColumn.HeaderTemplate>
                            <DataTemplate>
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition />
                                        <RowDefinition />
                                    </Grid.RowDefinitions>
                                    <Border
                                        Padding="{Binding RelativeSource={RelativeSource Self}, Path=(wpf:DataGridAssist.ColumnHeaderPadding), Converter={StaticResource HeaderPaddingConverter}}">
                                        <Canvas Height="{Binding ElementName=HeaderGroup, Path=ActualHeight}">
                                            <Grid>
                                                <Grid.Style>
                                                    <Style TargetType="Grid">
                                                        <Setter Property="Width">
                                                            <Setter.Value>
                                                                <MultiBinding Converter="{StaticResource MultipleWidthConverter}">
                                                                    <Binding ElementName="XauNoiMa" Path="ActualWidth"/>
                                                                    <Binding ElementName="MoTa" Path="ActualWidth"/>
                                                                </MultiBinding>
                                                            </Setter.Value>
                                                        </Setter>
                                                    </Style>
                                                </Grid.Style>
                                                <TextBlock HorizontalAlignment="Center" Text="Mục lục ngân sách"/>
                                            </Grid>
                                        </Canvas>
                                    </Border>
                                    <Border
                                        Grid.Row="1"
                                        Padding="{Binding RelativeSource={RelativeSource Self}, Path=(wpf:DataGridAssist.ColumnHeaderPadding)}"
                                        BorderThickness="0 1 1 0"
                                        BorderBrush="{Binding HorizontalGridLinesBrush, RelativeSource={RelativeSource AncestorType=DataGrid}}">
                                        <TextBlock Name="HeaderGroup" Text="{Binding}"/>
                                    </Border>
                                </Grid>
                            </DataTemplate>
                        </DataGridColumn.HeaderTemplate>
                    </component:DataGridTextColumn>
                    <component:DataGridTextColumn 
                        x:Name="MoTa"
                        Binding="{Binding MoTa}" 
                        Header="Mô tả"
                        IsReadOnly="True"
                        ElementStyle="{StaticResource DataGridTextColumnDetailStyle}"
                        HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                        HeaderTemplate="{StaticResource RightHeader}"/>
                    <component:DataGridTextColumn 
                        x:Name="RThieuUy"
                        Header="1/"
                        Width="70"
                        StringFormat="{}{0:N0}"
                        IsReadOnly="{Binding IsChungTuReadOnly}"
                        Binding="{Binding ThieuUy, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}, UpdateSourceTrigger=LostFocus}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        EditingElementStyle="{StaticResource DataGridTextColumnEditingRightCell}"
                        HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}">
                        <DataGridColumn.HeaderTemplate>
                            <DataTemplate>
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition />
                                        <RowDefinition />
                                    </Grid.RowDefinitions>
                                    <Border
                                        Padding="{Binding RelativeSource={RelativeSource Self}, Path=(wpf:DataGridAssist.ColumnHeaderPadding), Converter={StaticResource HeaderPaddingConverter}}">
                                        <Canvas Height="{Binding ElementName=HeaderGroup, Path=ActualHeight}">
                                            <Grid>
                                                <Grid.Style>
                                                    <Style TargetType="Grid">
                                                        <Setter Property="Width">
                                                            <Setter.Value>
                                                                <MultiBinding Converter="{StaticResource MultipleWidthConverter}">
                                                                    <Binding ElementName="RThieuUy" Path="ActualWidth"/>
                                                                    <Binding ElementName="RTrungUy" Path="ActualWidth"/>
                                                                    <Binding ElementName="RThuongUy" Path="ActualWidth"/>
                                                                    <Binding ElementName="RDaiUy" Path="ActualWidth"/>
                                                                    <Binding ElementName="RThieuTa" Path="ActualWidth"/>
                                                                    <Binding ElementName="RTrungTa" Path="ActualWidth"/>
                                                                    <Binding ElementName="RThuongTa" Path="ActualWidth"/>
                                                                    <Binding ElementName="RDaiTa" Path="ActualWidth"/>
                                                                    <Binding ElementName="RTuong" Path="ActualWidth"/>
                                                                    <Binding ElementName="TongSiQuan" Path="ActualWidth"/>
                                                                </MultiBinding>
                                                            </Setter.Value>
                                                        </Setter>
                                                    </Style>
                                                </Grid.Style>
                                                <TextBlock HorizontalAlignment="Center" Text="Sĩ quan"/>
                                            </Grid>
                                        </Canvas>
                                    </Border>
                                    <Border
                                        Grid.Row="1"
                                        Padding="{Binding RelativeSource={RelativeSource Self}, Path=(wpf:DataGridAssist.ColumnHeaderPadding)}"
                                        BorderThickness="0 1 1 0"
                                        BorderBrush="{Binding HorizontalGridLinesBrush, RelativeSource={RelativeSource AncestorType=DataGrid}}">
                                        <TextBlock Name="HeaderGroup" Text="{Binding}"/>
                                    </Border>
                                </Grid>
                            </DataTemplate>
                        </DataGridColumn.HeaderTemplate>
                    </component:DataGridTextColumn>
                    <component:DataGridTextColumn 
                        x:Name="RTrungUy"
                        Header="2/"
                        Width="70"
                        StringFormat="{}{0:N0}"
                        IsReadOnly="{Binding IsChungTuReadOnly}"
                        Binding="{Binding TrungUy, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}, UpdateSourceTrigger=LostFocus}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        EditingElementStyle="{StaticResource DataGridTextColumnEditingRightCell}"
                        HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                        HeaderTemplate="{StaticResource CenterHeader}"/>
                    <component:DataGridTextColumn 
                        x:Name="RThuongUy"
                        Header="3/"
                        Width="70"
                        StringFormat="{}{0:N0}"
                        IsReadOnly="{Binding IsChungTuReadOnly}"
                        Binding="{Binding ThuongUy, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}, UpdateSourceTrigger=LostFocus}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        EditingElementStyle="{StaticResource DataGridTextColumnEditingRightCell}"
                        HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                        HeaderTemplate="{StaticResource CenterHeader}"/>
                    <component:DataGridTextColumn 
                        x:Name="RDaiUy"
                        Header="4/"
                        Width="70"
                        StringFormat="{}{0:N0}"
                        IsReadOnly="{Binding IsChungTuReadOnly}"
                        Binding="{Binding DaiUy, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}, UpdateSourceTrigger=LostFocus}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        EditingElementStyle="{StaticResource DataGridTextColumnEditingRightCell}"
                        HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                        HeaderTemplate="{StaticResource CenterHeader}"/>
                    <component:DataGridTextColumn 
                        x:Name="RThieuTa"
                        Header="1//"
                        Width="70"
                        StringFormat="{}{0:N0}"
                        IsReadOnly="{Binding IsChungTuReadOnly}"
                        Binding="{Binding ThieuTa, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}, UpdateSourceTrigger=LostFocus}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        EditingElementStyle="{StaticResource DataGridTextColumnEditingRightCell}"
                        HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                        HeaderTemplate="{StaticResource CenterHeader}"/>
                    <component:DataGridTextColumn
                        Header="2//"
                        Width="70"
                        x:Name="RTrungTa"
                        StringFormat="{}{0:N0}"
                        IsReadOnly="{Binding IsChungTuReadOnly}"
                        Binding="{Binding TrungTa, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}, UpdateSourceTrigger=LostFocus}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        EditingElementStyle="{StaticResource DataGridTextColumnEditingRightCell}"
                        HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                        HeaderTemplate="{StaticResource CenterHeader}"/>
                    <component:DataGridTextColumn 
                        x:Name="RThuongTa"
                        Header="3//"
                        Width="70"
                        StringFormat="{}{0:N0}"
                        IsReadOnly="{Binding IsChungTuReadOnly}"
                        Binding="{Binding ThuongTa, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}, UpdateSourceTrigger=LostFocus}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        EditingElementStyle="{StaticResource DataGridTextColumnEditingRightCell}"
                        HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                        HeaderTemplate="{StaticResource CenterHeader}"/>
                    <component:DataGridTextColumn 
                        x:Name="RDaiTa"
                        Header="4//"
                        Width="70"
                        StringFormat="{}{0:N0}"
                        IsReadOnly="{Binding IsChungTuReadOnly}"
                        Binding="{Binding DaiTa, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}, UpdateSourceTrigger=LostFocus}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        EditingElementStyle="{StaticResource DataGridTextColumnEditingRightCell}"
                        HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                        HeaderTemplate="{StaticResource CenterHeader}"/>
                    <component:DataGridTextColumn 
                        x:Name="RTuong"
                        Header="*"
                        Width="70"
                        StringFormat="{}{0:N0}"
                        IsReadOnly="{Binding IsChungTuReadOnly}"
                        Binding="{Binding Tuong, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}, UpdateSourceTrigger=LostFocus}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        EditingElementStyle="{StaticResource DataGridTextColumnEditingRightCell}"
                        HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                        HeaderTemplate="{StaticResource CenterHeader}"/>
                    <component:DataGridTextColumn 
                        x:Name="TongSiQuan"
                        Header="(+)"
                        Width="70"
                        StringFormat="{}{0:N0}"
                        Binding="{Binding TongSiQuan, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}, UpdateSourceTrigger=LostFocus}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        FontWeight="Bold"
                        IsReadOnly="True"
                        HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                        HeaderTemplate="{StaticResource RightHeader}"/>
                    <component:DataGridTextColumn 
                        x:Name="RBinhNhi"
                        Header="B2"
                        Width="70"
                        StringFormat="{}{0:N0}"
                        IsReadOnly="{Binding IsChungTuReadOnly}"
                        Binding="{Binding BinhNhi, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}, UpdateSourceTrigger=LostFocus}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        EditingElementStyle="{StaticResource DataGridTextColumnEditingRightCell}"
                        HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}">
                        <DataGridColumn.HeaderTemplate>
                            <DataTemplate>
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition />
                                        <RowDefinition />
                                    </Grid.RowDefinitions>
                                    <Border
                                        Padding="{Binding RelativeSource={RelativeSource Self}, Path=(wpf:DataGridAssist.ColumnHeaderPadding), Converter={StaticResource HeaderPaddingConverter}}">
                                        <Canvas Height="{Binding ElementName=HeaderGroup, Path=ActualHeight}">
                                            <Grid>
                                                <Grid.Style>
                                                    <Style TargetType="Grid">
                                                        <Setter Property="Width">
                                                            <Setter.Value>
                                                                <MultiBinding Converter="{StaticResource MultipleWidthConverter}">
                                                                    <Binding ElementName="RBinhNhi" Path="ActualWidth"/>
                                                                    <Binding ElementName="RBinhNhat" Path="ActualWidth"/>
                                                                    <Binding ElementName="RHaSi" Path="ActualWidth"/>
                                                                    <Binding ElementName="RTrungSi" Path="ActualWidth"/>
                                                                    <Binding ElementName="RThuongSi" Path="ActualWidth"/>
                                                                    <Binding ElementName="TongHaSiQuan" Path="ActualWidth"/>
                                                                </MultiBinding>
                                                            </Setter.Value>
                                                        </Setter>
                                                    </Style>
                                                </Grid.Style>
                                                <TextBlock HorizontalAlignment="Center" Text="Hạ sĩ quan, chiến sĩ"/>
                                            </Grid>
                                        </Canvas>
                                    </Border>
                                    <Border
                                        Grid.Row="1"
                                        Padding="{Binding RelativeSource={RelativeSource Self}, Path=(wpf:DataGridAssist.ColumnHeaderPadding)}"
                                        BorderThickness="0 1 1 0"
                                        BorderBrush="{Binding HorizontalGridLinesBrush, RelativeSource={RelativeSource AncestorType=DataGrid}}">
                                        <TextBlock Name="HeaderGroup" Text="{Binding}"/>
                                    </Border>
                                </Grid>
                            </DataTemplate>
                        </DataGridColumn.HeaderTemplate>
                    </component:DataGridTextColumn>
                    <component:DataGridTextColumn 
                        x:Name="RBinhNhat"
                        Header="B1"
                        Width="70"
                        StringFormat="{}{0:N0}"
                        IsReadOnly="{Binding IsChungTuReadOnly}"
                        Binding="{Binding BinhNhat, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}, UpdateSourceTrigger=LostFocus}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        EditingElementStyle="{StaticResource DataGridTextColumnEditingRightCell}"
                        HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                        HeaderTemplate="{StaticResource CenterHeader}"/>
                    <component:DataGridTextColumn 
                        x:Name="RHaSi"
                        Header="H1"
                        Width="70"
                        StringFormat="{}{0:N0}"
                        IsReadOnly="{Binding IsChungTuReadOnly}"
                        Binding="{Binding HaSi, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}, UpdateSourceTrigger=LostFocus}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        EditingElementStyle="{StaticResource DataGridTextColumnEditingRightCell}"
                        HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                        HeaderTemplate="{StaticResource CenterHeader}"/>
                    <component:DataGridTextColumn 
                        x:Name="RTrungSi"
                        Header="H2"
                        Width="70"
                        StringFormat="{}{0:N0}"
                        IsReadOnly="{Binding IsChungTuReadOnly}"
                        Binding="{Binding TrungSi, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}, UpdateSourceTrigger=LostFocus}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        EditingElementStyle="{StaticResource DataGridTextColumnEditingRightCell}"
                        HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                        HeaderTemplate="{StaticResource CenterHeader}"/>
                    <component:DataGridTextColumn 
                        x:Name="RThuongSi"
                        Header="H3"
                        Width="70"
                        StringFormat="{}{0:N0}"
                        IsReadOnly="{Binding IsChungTuReadOnly}"
                        Binding="{Binding ThuongSi, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}, UpdateSourceTrigger=LostFocus}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        EditingElementStyle="{StaticResource DataGridTextColumnEditingRightCell}"
                        HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                        HeaderTemplate="{StaticResource CenterHeader}"/>
                    <DataGridTextColumn 
                        x:Name="TongHaSiQuan"
                        Header="(+)"
                        Width="70"
                        Binding="{Binding TongHaSiQuan, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}}" 
                        IsReadOnly="True"
                        FontWeight="Bold"
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                        HeaderTemplate="{StaticResource RightHeader}"/>
                    <component:DataGridTextColumn 
                        x:Name="RQncn"
                        Header="QNCN"
                        Width="70"
                        StringFormat="{}{0:N0}"
                        IsReadOnly="{Binding IsChungTuReadOnly}"
                        Binding="{Binding Qncn, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}, UpdateSourceTrigger=LostFocus}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        EditingElementStyle="{StaticResource DataGridTextColumnEditingRightCell}"
                        HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}">
                        <DataGridColumn.HeaderTemplate>
                            <DataTemplate>
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition />
                                        <RowDefinition />
                                    </Grid.RowDefinitions>
                                    <Border
                                        Padding="{Binding RelativeSource={RelativeSource Self}, Path=(wpf:DataGridAssist.ColumnHeaderPadding), Converter={StaticResource HeaderPaddingConverter}}">
                                        <Canvas Height="{Binding ElementName=HeaderGroup, Path=ActualHeight}">
                                            <Grid>
                                                <Grid.Style>
                                                    <Style TargetType="Grid">
                                                        <Setter Property="Width">
                                                            <Setter.Value>
                                                                <MultiBinding Converter="{StaticResource MultipleWidthConverter}">
                                                                    <Binding ElementName="RQncn" Path="ActualWidth"/>
                                                                    <Binding ElementName="RVcqp" Path="ActualWidth"/>
                                                                    <Binding ElementName="RCnvqp" Path="ActualWidth"/>
                                                                    <Binding ElementName="RCcqp" Path="ActualWidth"/>
                                                                </MultiBinding>
                                                            </Setter.Value>
                                                        </Setter>
                                                    </Style>
                                                </Grid.Style>
                                                <TextBlock HorizontalAlignment="Center" Text="CNVCQP"/>
                                            </Grid>
                                        </Canvas>
                                    </Border>
                                    <Border
                                        Grid.Row="1"
                                        Padding="{Binding RelativeSource={RelativeSource Self}, Path=(wpf:DataGridAssist.ColumnHeaderPadding)}"
                                        BorderThickness="0 1 1 0"
                                        BorderBrush="{Binding HorizontalGridLinesBrush, RelativeSource={RelativeSource AncestorType=DataGrid}}">
                                        <TextBlock Name="HeaderGroup" Text="{Binding}"/>
                                    </Border>
                                </Grid>
                            </DataTemplate>
                        </DataGridColumn.HeaderTemplate>
                    </component:DataGridTextColumn>
                    <component:DataGridTextColumn 
                        x:Name="RVcqp"
                        Header="VCQP"
                        Width="70"
                        StringFormat="{}{0:N0}"
                        IsReadOnly="{Binding IsChungTuReadOnly}"
                        Binding="{Binding Vcqp, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}, UpdateSourceTrigger=LostFocus}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        EditingElementStyle="{StaticResource DataGridTextColumnEditingRightCell}"
                        HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                        HeaderTemplate="{StaticResource CenterHeader}"/>
                    <component:DataGridTextColumn 
                        x:Name="RCnvqp"
                        Header="CNQP"
                        Width="70"
                        StringFormat="{}{0:N0}"
                        IsReadOnly="{Binding IsChungTuReadOnly}"
                        Binding="{Binding Cnqp, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}, UpdateSourceTrigger=LostFocus}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        EditingElementStyle="{StaticResource DataGridTextColumnEditingRightCell}"
                        HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                        HeaderTemplate="{StaticResource CenterHeader}"/>
                    <component:DataGridTextColumn 
                        x:Name="RCcqp"
                        Header="CCQP"
                        Width="70"
                        StringFormat="{}{0:N0}"
                        IsReadOnly="{Binding IsChungTuReadOnly}"
                        Binding="{Binding Ccqp, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}, UpdateSourceTrigger=LostFocus}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        EditingElementStyle="{StaticResource DataGridTextColumnEditingRightCell}"
                        HeaderStyle="{StaticResource DataGridColumnHeaderNoBorder}"
                        HeaderTemplate="{StaticResource RightHeader}"/>
                    <component:DataGridTextColumn 
                        x:Name="RLdhd"
                        Header="Khác"
                        Width="70"
                        StringFormat="{}{0:N0}"
                        IsReadOnly="{Binding IsChungTuReadOnly}"
                        Binding="{Binding Ldhd, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}, UpdateSourceTrigger=LostFocus}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        EditingElementStyle="{StaticResource DataGridTextColumnEditingRightCell}"/>
                    <component:DataGridTextColumn 
                        x:Name="GhiChu"
                        Header="Ghi chú"
                        Binding="{Binding GhiChu, UpdateSourceTrigger=LostFocus}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailStyle}"
                        EditingElementStyle="{StaticResource DataGridTextColumnEditingStyle}"/>
                    <component:DataGridTextColumn 
                        x:Name="Tong"
                        Header="Tổng cộng"
                        Binding="{Binding TongSo, StringFormat={}{0:N0}, Converter={StaticResource NumberToStringEmptyConverter}}" 
                        ElementStyle="{StaticResource DataGridTextColumnDetailRightStyle}"
                        IsReadOnly="True"
                        FontWeight="Bold">
                    </component:DataGridTextColumn>
                </DataGrid.Columns>
            </component:ExpandedDataGrid>
        </Grid>
    </materialDesign:DialogHost>
</Window>
